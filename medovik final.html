<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Ø­Ø§Ø³Ø¨Ø© Medovik Ø§Ù„Ø¹Ù„Ù…ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„</title>
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2d3748;
            --accent: #3182ce;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --bg: #f7fafc;
            --card: #ffffff;
            --border: #e2e8f0;
            --text: #2d3748;
            --text-light: #718096;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--bg);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
        }

        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .tabs-container {
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .tab-buttons {
            display: flex;
            background: var(--primary);
            overflow-x: auto;
        }

        .tab-btn {
            padding: 15px 20px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .tab-btn.active {
            background: var(--accent);
            border-bottom-color: white;
        }

        .tab-content {
            padding: 30px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }

        h3 {
            color: var(--secondary);
            margin: 25px 0 15px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        .btn {
            padding: 12px 24px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: #2c5aa0;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-danger {
            background: var(--danger);
        }

        .result-box {
            background: var(--bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .quality-score {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 0;
        }

        .score-high { background: #c6f6d5; color: #22543d; }
        .score-medium { background: #fefcbf; color: #744210; }
        .score-low { background: #fed7d7; color: #742a2a; }

        .progress-bar {
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .progress-high { background: var(--success); }
        .progress-medium { background: var(--warning); }
        .progress-low { background: var(--danger); }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f7fafc;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 4px solid;
        }

        .alert-info {
            background: #ebf8ff;
            border-right-color: var(--accent);
            color: #2c5282;
        }

        .alert-success {
            background: #f0fff4;
            border-right-color: var(--success);
            color: #22543d;
        }

        .alert-warning {
            background: #fffaf0;
            border-right-color: var(--warning);
            color: #744210;
        }

        .alert-danger {
            background: #fff5f5;
            border-right-color: var(--danger);
            color: #742a2a;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-box {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .comparison-before {
            background: #fff5f5;
            border: 1px solid #fed7d7;
        }

        .comparison-after {
            background: #f0fff4;
            border: 1px solid #c6f6d5;
        }

        .timeline {
            border-right: 3px solid var(--accent);
            padding-right: 25px;
            margin: 25px 0;
        }

        .timeline-item {
            position: relative;
            padding: 15px 0;
            margin-bottom: 20px;
        }

        .timeline-item:before {
            content: '';
            position: absolute;
            right: -28px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent);
            border: 4px solid white;
            box-shadow: 0 0 0 2px var(--accent);
        }

        .timeline-time {
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 6px;
            font-size: 16px;
        }

        .timeline-temp {
            color: var(--warning);
            font-weight: 600;
            margin: 5px 0;
        }

        .timeline-temp.danger { color: var(--danger); }
        .timeline-temp.warning { color: var(--warning); }
        .timeline-temp.success { color: var(--success); }

        .method-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .method-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .temp-badge {
            background: var(--warning);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 13px;
        }

        .text-parser-section, .advanced-scaling-section {
            margin: 25px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .star-rating {
            display: flex;
            direction: ltr;
            margin: 10px 0;
        }

        .star {
            font-size: 24px;
            color: #e2e8f0;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star.active, .star:hover {
            color: #f59e0b;
        }

        .scaling-mode-toggle {
            display: flex;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .btn-mode {
            flex: 1;
            border-radius: 0;
            background: var(--card);
            color: var(--text);
        }

        .btn-mode.active {
            background: var(--accent);
            color: white;
        }

        .scaling-content {
            display: none;
        }

        .scaling-content.active {
            display: block;
        }

        .advisor-detail {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .advisor-detail h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .advisor-effects {
            background: #f7fafc;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .advisor-solution {
            background: #f0fff4;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-right: 3px solid var(--success);
        }

        .troubleshooting-wizard {
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
        }

        .problem-option {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .problem-option:hover {
            border-color: var(--accent);
            background: #f0f9ff;
        }

        .solution-card {
            background: #f0fff4;
            border: 1px solid #c6f6d5;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .method-content {
            display: none;
        }

        .method-content.active {
            display: block;
        }

        .reverse-calculator-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .prediction-warning {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .learning-insights {
            background: #f0fff4;
            border: 1px solid #c6f6d5;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .tab-buttons {
                flex-direction: column;
            }
            
            .tab-btn {
                width: 100%;
                text-align: center;
            }
            
            .comparison {
                grid-template-columns: 1fr;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            body {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¯ Ø­Ø§Ø³Ø¨Ø© Medovik Ø§Ù„Ø¹Ù„Ù…ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„</h1>
            <p class="subtitle">Ø£Ø¯Ø§Ø© Ø¹Ù„Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø¨Ø­Ø§Ø« ÙÙŠ ÙƒÙŠÙ…ÙŠØ§Ø¡ Ø§Ù„Ø®Ø¨Ø²</p>
        </header>

        <div class="tabs-container">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="analyzer">ğŸ“Š Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ</button>
                <button class="tab-btn" data-tab="converter">ğŸ”„ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ</button>
                <button class="tab-btn" data-tab="scientific">ğŸ”¬ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</button>
                <button class="tab-btn" data-tab="tempering">ğŸ§ª Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬</button>
                <button class="tab-btn" data-tab="troubleshooting">ğŸ”§ Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø´Ø§ÙƒÙ„</button>
                <button class="tab-btn" data-tab="calculator">ğŸ“ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª</button>
                <button class="tab-btn" data-tab="advisor">âš ï¸ Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠ</button>
                <button class="tab-btn" data-tab="library">ğŸ’¾ Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙˆØµÙØ§Øª</button>
            </div>

            <div class="tab-content">
                <!-- Tab 1: Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ -->
                <div class="tab-panel active" id="analyzer">
                    <h2>ğŸ“Š Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ</h2>
                    <div class="alert alert-info">
                        <strong>ğŸ’¡ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø­Ø§Ø«:</strong> Ø§Ù„Ø¯Ù‚ÙŠÙ‚: 500ØºØŒ Ø§Ù„Ø²Ø¨Ø¯Ø©: 120ØºØŒ Ø§Ù„Ø³ÙƒØ±: 200ØºØŒ Ø§Ù„Ø¹Ø³Ù„: 100ØºØŒ Ø§Ù„Ø¨ÙŠØ¶: 95ØºØŒ Ø§Ù„ØµÙˆØ¯Ø§: 5.5Øº
                    </div>

                    <div class="input-group">
                        <label for="flour">Ø¯Ù‚ÙŠÙ‚ (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="flour" value="500" min="0" step="1">
                    </div>

                    <div class="input-group">
                        <label for="butter">Ø²Ø¨Ø¯Ø© (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="butter" value="120" min="0" step="1">
                    </div>

                    <div class="input-group">
                        <label for="sugar">Ø³ÙƒØ± (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="sugar" value="200" min="0" step="1">
                    </div>

                    <div class="input-group">
                        <label for="honey">Ø¹Ø³Ù„ (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="honey" value="100" min="0" step="1">
                    </div>

                    <div class="input-group">
                        <label for="eggs">Ø¨ÙŠØ¶ (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="eggs" value="95" min="0" step="1">
                    </div>

                    <div class="input-group">
                        <label for="soda">Ø¨ÙŠÙƒÙ†Ø¬ ØµÙˆØ¯Ø§ (Ø¬Ø±Ø§Ù…):</label>
                        <input type="number" id="soda" value="5.5" min="0" step="0.1">
                    </div>

                    <button class="btn" id="analyze-btn">ğŸ§ª ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙØ©</button>
                    <button class="btn btn-secondary" id="reset-btn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>

                    <!-- Ù…Ø­Ù„Ù„ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø­Ø³Ù† -->
                    <div class="text-parser-section">
                        <h3>ğŸ“ Ù…Ø­Ù„Ù„ Ø§Ù„ÙˆØµÙØ§Øª (Ø§Ù†Ø³Ø® ÙˆØ§Ù„ØµÙ‚ ÙˆØµÙØªÙƒ)</h3>
                        <div class="alert alert-info">
                            <strong>ğŸ’¡ ÙŠØ¯Ø¹Ù…:</strong> Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© - "200Ø¬Ù… Ø²Ø¨Ø¯Ø©" Ø£Ùˆ "130g butter" Ø£Ùˆ "Ù£ Ø¨ÙŠØ¶Ø§Øª"
                        </div>
                        
                        <textarea id="recipeText" placeholder="Ø§Ù„ØµÙ‚ ÙˆØµÙØªÙƒ Ù‡Ù†Ø§...&#10;Ù…Ø«Ø§Ù„ 1: 200Ø¬Ù… Ø²Ø¨Ø¯Ø©ØŒ 150Ø¬Ù… Ø³ÙƒØ±ØŒ 100Ø¬Ù… Ø¹Ø³Ù„ØŒ 3 Ø¨ÙŠØ¶Ø§ØªØŒ 500Ø¬Ù… Ø¯Ù‚ÙŠÙ‚&#10;Ù…Ø«Ø§Ù„ 2: Ù¡Ù¥Ù  ØºØ±Ø§Ù… Ø²Ø¨Ø¯Ø©ØŒ Ù¡Ù Ù  ØºØ±Ø§Ù… Ø³ÙƒØ±ØŒ Ù¨Ù  ØºØ±Ø§Ù… Ø¹Ø³Ù„ØŒ Ù¤ Ø¨ÙŠØ¶Ø§ØªØŒ Ù¤Ù¥Ù  ØºØ±Ø§Ù… Ø¯Ù‚ÙŠÙ‚" rows="6"></textarea>
                        
                        <div class="parser-actions">
                            <button class="btn" id="parseRecipeBtn">ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ</button>
                            <button class="btn btn-secondary" id="clearTextBtn">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
                        </div>
                        
                        <div id="parseResults" class="result-box" style="display: none;">
                            <h4>âœ… ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙØ©:</h4>
                            <div id="parsedIngredientsList"></div>
                            <div class="controls">
                                <button class="btn btn-success" id="applyParsedRecipe">ğŸ“¥ ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ…</button>
                                <button class="btn btn-primary" id="saveParsedRecipe">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ÙˆØµÙØ©</button>
                            </div>
                        </div>
                    </div>

                    <div class="result-box" id="analysis-result">
                        <p>Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ ØªØ­Ù„ÙŠÙ„ ÙˆØµÙØªÙƒ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙØ©"</p>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ - Ù…Ø­Ø¯Ø« -->
                <div class="tab-panel" id="converter">
                    <h2>ğŸ”„ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ</h2>
                    <div id="converter-content">
                        <p>ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰... Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ù…Ø­ÙˆÙ„ Ø§Ù„Ù…Ù†Ù‡Ø¬ÙŠØ§Øª Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© - Ù…Ø­Ø¯Ø« -->
                <div class="tab-panel" id="scientific">
                    <h2>ğŸ”¬ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</h2>
                    <div id="scientific-content">
                        <p>ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰... Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <div class="tab-panel" id="tempering">
                    <h2>ğŸ§ª Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</h2>
                    
                    <div class="alert alert-info">
                        <strong>ğŸ”¬ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø°ÙƒÙŠ:</strong> Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©
                    </div>

                    <div class="input-grid">
                        <div class="input-group">
                            <label for="eggMass">ÙƒØªÙ„Ø© Ø§Ù„Ø¨ÙŠØ¶ (ØºØ±Ø§Ù…):</label>
                            <input type="number" id="eggMass" value="150" min="1" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="eggTemp">Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¶ (Â°C):</label>
                            <input type="number" id="eggTemp" value="20" min="0" max="30" step="0.1">
                        </div>
                        
                        <div class="input-group">
                            <label for="liquidMass">ÙƒØªÙ„Ø© Ø§Ù„Ø®Ù„ÙŠØ· Ø§Ù„Ø³Ø§Ø®Ù† (ØºØ±Ø§Ù…):</label>
                            <input type="number" id="liquidMass" value="430" min="1" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="liquidTemp">Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø®Ù„ÙŠØ· (Â°C):</label>
                            <input type="number" id="liquidTemp" value="85" min="60" max="120" step="0.1">
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="batchCount">Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª:</label>
                        <select id="batchCount">
                            <option value="3">3 Ø¯ÙØ¹Ø§Øª</option>
                            <option value="4">4 Ø¯ÙØ¹Ø§Øª</option>
                            <option value="5" selected>5 Ø¯ÙØ¹Ø§Øª (Ù…Ø³ØªØ­Ø³Ù†)</option>
                        </select>
                    </div>

                    <button class="btn btn-success" id="calculateTempering">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¢Ù…Ù†</button>
                    <button class="btn btn-secondary" id="autoFill">ğŸ”„ ØªØ¹Ø¨Ø¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„ÙˆØµÙØ©</button>

                    <div id="temperingResults" class="result-box" style="display: none; margin-top: 20px;">
                        <h4>ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¹Ù„Ù…ÙŠ</h4>
                        <div id="temperatureProgression"></div>
                        <div id="batchDetails"></div>
                        <div id="safetyWarnings"></div>
                        
                        <div class="progress-container" style="margin: 15px 0;">
                            <div id="temperatureVisualization" style="height: 30px; background: linear-gradient(90deg, #3182ce 0%, #d69e2e 50%, #e53e3e 100%); border-radius: 5px; position: relative;"></div>
                            <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                                <span>20Â°C</span>
                                <span>40Â°C</span>
                                <span>60Â°C</span>
                                <span>68Â°C âš ï¸</span>
                                <span>85Â°C</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ -->
                <div class="tab-panel" id="troubleshooting">
                    <h2>ğŸ”§ Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø´Ø§ÙƒÙ„</h2>
                    <div class="alert alert-info">
                        <strong>ğŸ¯ Ø­Ù„ÙˆÙ„ Ø¹Ù…Ù„ÙŠØ© Ù„Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©:</strong> Ø§Ø®ØªØ± Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­Ù„ÙˆÙ„ Ø¹Ù„Ù…ÙŠØ© Ù…Ø®ØµØµØ©.
                    </div>
                    
                    <div class="troubleshooting-wizard">
                        <div class="wizard-step active" id="step1">
                            <h3>Ù…Ø§ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ØŸ</h3>
                            <button class="problem-option" data-problem="sticky">Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø© Ø¬Ø¯Ø§Ù‹</button>
                            <button class="problem-option" data-problem="dry">Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© Ø¬Ø§ÙØ© ÙˆÙ…ØªÙØªØªØ©</button>
                            <button class="problem-option" data-problem="hard">Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ù‚Ø§Ø³ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ø¨Ø²</button>
                            <button class="problem-option" data-problem="bitter">Ø·Ø¹Ù… Ù‚Ù„ÙˆÙŠ (ØµØ§Ø¨ÙˆÙ†ÙŠ)</button>
                            <button class="problem-option" data-problem="pale">Ø§Ù„Ù„ÙˆÙ† Ø¨Ø§Ù‡Øª Ø¬Ø¯Ø§Ù‹</button>
                        </div>
                        
                        <div class="wizard-step" id="step2">
                            <div id="solution-content"></div>
                            <button class="btn btn-secondary" id="back-to-problems">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø´Ø§ÙƒÙ„</button>
                        </div>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª - Ù…Ø­Ø¯Ø« -->
                <div class="tab-panel" id="calculator">
                    <h2>ğŸ“ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª</h2>
                    <div class="alert alert-info">
                        <strong>ğŸ“ Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù‚Ø¹ÙŠØ©:</strong> ØªØ³ØªØ®Ø¯Ù… ÙƒØ«Ø§ÙØ© 1.25 Ø¬Ù…/Ø³Ù…Â³ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©.
                    </div>
                    
                    <!-- Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ© -->
                    <div class="reverse-calculator-section">
                        <h3>ğŸ”„ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ©</h3>
                        <div class="alert alert-info">
                            <strong>Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª â† Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ±</strong> 
                        </div>
                        
                        <div class="input-group">
                            <label for="targetLayersReverse">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</label>
                            <input type="number" id="targetLayersReverse" value="7" min="1" max="20">
                        </div>
                        
                        <div class="input-group">
                            <label for="layerDiameter">Ù‚Ø·Ø± Ø§Ù„Ø·Ø¨Ù‚Ø© (Ø³Ù…):</label>
                            <input type="number" id="layerDiameter" value="24" min="10" max="40">
                        </div>
                        
                        <div class="input-group">
                            <label for="layerThickness">Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø·Ø¨Ù‚Ø© (Ù…Ù„Ù…):</label>
                            <input type="number" id="layerThickness" value="2" min="1" max="5" step="0.5">
                        </div>
                        
                        <button class="btn btn-success" id="calculateReverse">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª</button>
                        
                        <div id="reverseResults" class="result-box" style="display: none;">
                            <h4>ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ©</h4>
                            <div id="reverseCalculations"></div>
                            <button class="btn btn-primary" id="applyReverseResults">ğŸ“¥ ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ±</button>
                        </div>
                    </div>
                    
                    <div class="advanced-scaling-section">
                        <h3>ğŸ¯ Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h3>
                        
                        <div class="scaling-mode-toggle">
                            <button class="btn-mode active" data-mode="basic">Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©</button>
                            <button class="btn-mode" data-mode="advanced">Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</button>
                        </div>
                        
                        <div id="basicScalingContent" class="scaling-content active">
                            <div id="calculator-content">
                                <p>ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰... Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
                            </div>
                        </div>
                        
                        <div id="advancedScalingContent" class="scaling-content">
                            <div class="input-group">
                                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</label>
                                <input type="number" id="targetLayers" value="7" min="1" max="20">
                            </div>
                            
                            <div class="input-group">
                                <label>ÙˆØ²Ù† ÙƒÙ„ Ø·Ø¨Ù‚Ø© (Ø¬Ù…):</label>
                                <input type="number" id="layerWeight" value="150" min="50" max="300">
                                <small>Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡: 120-180 Ø¬Ù… Ù„Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©</small>
                            </div>
                            
                            <div class="input-group">
                                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„Ù„Ø·Ø­Ù† (%):</label>
                                <input type="number" id="extraPercentage" value="12" min="5" max="30">
                                <small>Ù„Ø¹Ù…Ù„ ÙØªØ§Øª Ù„Ù„ØªØ²ÙŠÙŠÙ† (10-15% Ù…Ø«Ø§Ù„ÙŠ)</small>
                            </div>
                            
                            <button class="btn btn-success" id="calculateAdvanced">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</button>
                            
                            <div id="advancedResults" class="result-box" style="display: none;">
                                <h4>ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h4>
                                <div id="advancedCalculations"></div>
                                <button class="btn btn-primary" id="applyAdvancedResults">ğŸ“¥ ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ±</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠ - Ù…Ø­Ø¯Ø« -->
                <div class="tab-panel" id="advisor">
                    <h2>âš ï¸ Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠ</h2>
                    <div id="advisor-content">
                        <p>ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰... Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙØµÙ„ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
                    </div>
                </div>

                <!-- ØªØ¨ÙˆÙŠØ¨ Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙˆØµÙØ§Øª - Ù…Ø­Ø¯Ø« -->
                <div class="tab-panel" id="library">
                    <h2>ğŸ’¾ Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙˆØµÙØ§Øª</h2>
                    
                    <div id="recipeFeedback" class="result-box" style="display: none; margin-bottom: 20px;">
                        <h4>ğŸ’¬ ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙØ©</h4>
                        <textarea id="recipeComment" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„ÙˆØµÙØ©... Ù†Ø¬Ø­ØªØŸ Ù…Ø§Ø°Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ø³ÙŠÙ†Ù‡ØŸ" rows="3"></textarea>
                        
                        <div class="rating-section">
                            <label>â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</label>
                            <div class="star-rating">
                                <span class="star" data-rating="1">â˜…</span>
                                <span class="star" data-rating="2">â˜…</span>
                                <span class="star" data-rating="3">â˜…</span>
                                <span class="star" data-rating="4">â˜…</span>
                                <span class="star" data-rating="5">â˜…</span>
                            </div>
                        </div>
                        
                        <div class="success-failure">
                            <label>Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
                            <button class="btn btn-success success-btn">âœ… Ù†Ø¬Ø­Øª</button>
                            <button class="btn btn-danger failure-btn">âŒ ÙØ´Ù„Øª</button>
                        </div>
                        
                        <button class="btn btn-primary" id="saveFeedback">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
                    </div>
                    
                    <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„Ù… Ù…Ù† Ø§Ù„ØªØ¬Ø§Ø±Ø¨ -->
                    <div id="learning-insights-section" style="display: none;">
                        <h3>ğŸ§  Ø§Ù„ØªØ¹Ù„Ù… Ù…Ù† ØªØ¬Ø§Ø±Ø¨Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
                        <div id="learning-insights-content"></div>
                    </div>
                    
                    <div id="library-content">
                        <p>ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰... Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <script>
        // ===== Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø§Ù„Ù…ØµØ­Ø­ ÙˆØ§Ù„Ù…Ø­Ø¯Ø« =====
        
        // ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© =====
        let currentRecipe = null;
        let currentAnalysis = null;
        let currentRating = 0;
        let currentSuccess = null;
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        let savedRecipes;
        try {
            const stored = localStorage.getItem('medovik_recipes');
            savedRecipes = stored ? JSON.parse(stored) : [];
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!Array.isArray(savedRecipes)) {
                console.warn('Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø© ÙÙŠ localStorageØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†...');
                savedRecipes = [];
            }
        } catch (e) {
            console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙØ§Øª:', e);
            savedRecipes = [];
            try {
                localStorage.removeItem('medovik_recipes');
            } catch {}
        }
    
        // Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ù…ØµØ­Ø­Ø© (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø­Ø§Ø«)
        const SCIENTIFIC_RANGES = {
            flour: { min: 48, max: 52, ideal: 50 },
            butter: { min: 10, max: 14, ideal: 12 },
            sugars: { min: 28, max: 33, ideal: 30.5 },
            eggs: { min: 8, max: 11, ideal: 9.5 },
            soda: { min: 0.3, max: 0.8, ideal: 0.55 }
        };
    
        // ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© Ø§Ù„Ù…ØµØ­Ø­Ø© Ù…Ù† Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©
        const DOUGH_DENSITY = 1.25; // g/cmÂ³
    
        // ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙŠ - Ù…Ø­Ø¯Ù‘Ø«Ø©
        // Ø§Ø¨Ø­Ø« Ø¹Ù† ingredientKeywords ÙˆØ§Ø³ØªØ¨Ø¯Ù„ Ø³Ø·Ø± soda:
        const ingredientKeywords = {
            flour: ['Ø¯Ù‚ÙŠÙ‚', 'Ø·Ø­ÙŠÙ†', 'flour', 'Ø¯Ù‚ÙŠÙ‚ Ø§Ø¨ÙŠØ¶', 'Ø·Ø­ÙŠÙ† Ø§Ø¨ÙŠØ¶', 'Ø¯Ù‚ÙŠÙ‚ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ù„Ø§Øª', 'Ø¯Ù‚ÙŠÙ‚ Ù…ØªØ¹Ø¯Ø¯'],
            butter: ['Ø²Ø¨Ø¯Ø©', 'Ø²Ø¨Ø¯', 'butter', 'Ø²Ø¨Ø¯Ø© ØºÙŠØ± Ù…Ù…Ù„Ø­Ø©', 'Ø²Ø¨Ø¯Ù‡', 'Ø²Ø¨Ø¯Ø© Ù…Ù…Ù„Ø­Ø©'],
            sugar: ['Ø³ÙƒØ±', 'Ø³ÙƒØ± Ø§Ø¨ÙŠØ¶', 'sugar', 'Ø³ÙƒØ± Ù†Ø§Ø¹Ù…', 'Ø³ÙƒØ±Ù‡'],
            honey: ['Ø¹Ø³Ù„', 'Ø¹Ø³Ù„ Ù†Ø­Ù„', 'honey', 'Ø¹Ø³Ù„ Ø·Ø¨ÙŠØ¹ÙŠ'],
            eggs: ['Ø¨ÙŠØ¶', 'Ø¨ÙŠØ¶Ø©', 'Ø¨ÙŠØ¶Ø§Øª', 'eggs', 'egg', 'Ø¨ÙŠØ¶ ÙƒØ§Ù…Ù„', 'Ø­Ø¨Ø§Øª Ø¨ÙŠØ¶', 'Ø­Ø¨Ø© Ø¨ÙŠØ¶', 'Ø¨ÙŠØ¶Ù‡', 'Ø­Ø¨Ø§Øª', 'Ø­Ø¨Ø©'],
            soda: ['ØµÙˆØ¯Ø§', 'Ø¨ÙŠÙƒÙ†Ø¬ ØµÙˆØ¯Ø§', 'Ø¨ÙŠÙƒØ±Ø¨ÙˆÙ†Ø§Øª', 'soda', 'baking soda', 'Ø¨ÙŠÙƒÙ†Øº ØµÙˆØ¯Ø§', 'Ø¨ÙŠÙƒØ±Ø¨ÙˆÙ†Ø§Øª Ø§Ù„ØµÙˆØ¯ÙŠÙˆÙ…', 'Ø¨ÙŠÙƒÙ†Ø¬', 'Ø¨ÙŠÙƒÙ†Øº'] // âœ… Ø£Ø¶ÙÙ†Ø§ "Ø¨ÙŠÙƒÙ†Ø¬" Ùˆ "Ø¨ÙŠÙƒÙ†Øº"
        };
    
        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…ØµØ­Ø­Ø© =====
        
        /**
         * ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© - Ù…ØµØ­Ø­
         */
        function normalizeArabicNumbers(text) {
            const arabicToEnglish = {
                'Ù ': '0', 'Ù¡': '1', 'Ù¢': '2', 'Ù£': '3', 'Ù¤': '4',
                'Ù¥': '5', 'Ù¦': '6', 'Ù§': '7', 'Ù¨': '8', 'Ù©': '9'
            };
            return text.replace(/[Ù -Ù©]/g, d => arabicToEnglish[d] || d);
        }
    
        /**
         * escape Ø£Ø­Ø±Ù regex Ø§Ù„Ø®Ø§ØµØ©
         */
        function escapeRegex(str) {
            return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }
    
        /**
         * Ø­ÙØ¸ Ø§Ù„ÙˆØµÙØ§Øª Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†
         */
        function saveRecipesToStorage() {
            try {
                localStorage.setItem('medovik_recipes', JSON.stringify(savedRecipes));
            } catch (e) {
                console.error('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„ÙˆØµÙØ§Øª:', e);
                alert('âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù‚Ø¯ ØªÙƒÙˆÙ† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù…Ù…ØªÙ„Ø¦Ø©.');
            }
        }
    
        // ===== Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØµØ­Ø­ =====
        
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initTabs();
                initButtons();
                initTextParser();
                initAdvancedScaling();
                initRatingSystem();
                initTroubleshooting();
                initReverseCalculator();
                initTemperingCalculator();
                initMethodConverter();
                
                // ØªØ­Ù„ÙŠÙ„ Ø£ÙˆÙ„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø©
                // const flourInput = document.getElementById('flour');
                // if (flourInput && flourInput.value) {
                    // analyzeRecipe();
                // }
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©:', e);
            }
        });
    
        // ===== Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª =====
        
        function initTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    tabBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.tab-panel').forEach(panel => {
                        panel.classList.remove('active');
                    });
                    
                    const tabId = this.getAttribute('data-tab');
                    const targetPanel = document.getElementById(tabId);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                    }
                });
            });
        }
    
        // ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù…ØµØ­Ø­Ø© =====
        
        function initButtons() {
            const analyzeBtn = document.getElementById('analyze-btn');
            const resetBtn = document.getElementById('reset-btn');
            
            if (analyzeBtn) {
                analyzeBtn.addEventListener('click', analyzeRecipe);
            }
            
            if (resetBtn) {
                resetBtn.addEventListener('click', resetForm);
            }
        }
    
        // ===== Ù†Ø¸Ø§Ù… Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ =====
        
        function initTroubleshooting() {
            const problemOptions = document.querySelectorAll('.problem-option');
            const backBtn = document.getElementById('back-to-problems');
            
            problemOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const problem = this.getAttribute('data-problem');
                    showSolution(problem);
                });
            });
            
            if (backBtn) {
                backBtn.addEventListener('click', function() {
                    const step1 = document.getElementById('step1');
                    const step2 = document.getElementById('step2');
                    if (step1) step1.classList.add('active');
                    if (step2) step2.classList.remove('active');
                });
            }
        }
    
        // ===== Ù…Ø­Ù„Ù„ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù…Ø­Ø³Ù‘Ù† ÙˆØ§Ù„Ù…ØµØ­Ø­ =====
        
        function initTextParser() {
            const parseBtn = document.getElementById('parseRecipeBtn');
            const clearBtn = document.getElementById('clearTextBtn');
            const applyBtn = document.getElementById('applyParsedRecipe');
            const saveBtn = document.getElementById('saveParsedRecipe');
            
            if (parseBtn) parseBtn.addEventListener('click', parseRecipeText);
            if (clearBtn) clearBtn.addEventListener('click', clearText);
            if (applyBtn) applyBtn.addEventListener('click', applyParsedRecipe);
            if (saveBtn) saveBtn.addEventListener('click', saveParsedRecipe);
        }
    
        /**
         * ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ - Ù…ØµØ­Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
         */
        function parseRecipeText() {
            const textArea = document.getElementById('recipeText');
            if (!textArea) return;
            
            const text = textArea.value.trim();
            if (!text) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„ÙˆØµÙØ© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const parsed = parseRecipeFromText(text);
            displayParsedResults(parsed);
        }
    
        /**
         * Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…Ù† Ø§Ù„Ù†Øµ - Ù…ØµØ­Ø­ ÙƒÙ„ÙŠØ§Ù‹
         */
        function parseRecipeFromText(text) {
            // ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
            text = normalizeArabicNumbers(text);
            
            const lines = text.split('\n');
            const result = { 
                flour: 0, 
                butter: 0, 
                sugar: 0, 
                honey: 0, 
                eggs: 0, 
                soda: 0 
            };
            
            lines.forEach(line => {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„ Ù…ÙƒÙˆÙ† ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±
                findIngredient(line, 'flour', result);
                findIngredient(line, 'butter', result);
                findIngredient(line, 'sugar', result);
                findIngredient(line, 'honey', result);
                findIngredient(line, 'eggs', result);
                findIngredient(line, 'soda', result);
            });
            
            return result;
        }
    
        /**
         * Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙƒÙˆÙ† ÙÙŠ Ø³Ø·Ø± - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø©
         */
        function findIngredient(line, ingredient, result) {
            const keywords = ingredientKeywords[ingredient];
            if (!keywords) return;
            
            // Ù†Ù…Ø· Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ³Ø¹
            const unitPattern = '(?:Ø¬Ù…|Ø¬Ø±Ø§Ù…|Øº|ØºØ±Ø§Ù…|g|gr|grams?|Ø¬Ø±Ø§Ù…Ø§Øª|ÙƒÙˆØ¨|ÙƒÙˆØ¨ÙŠÙ†|Ø£ÙƒÙˆØ§Ø¨|cups?|Ù…Ù„Ø¹Ù‚Ø©|Ù…Ù„Ø¹Ù‚ØªÙŠÙ†|Ù…Ù„Ø§Ø¹Ù‚|tbsp|tsp|tablespoons?|teaspoons?|sticks?|oz|ounces?|Ù…Ø¹Ù„Ù‚Ø©|Ù…Ø¹Ù„Ù‚ØªÙŠÙ†)';
            
            // ÙƒÙ„Ù…Ø§Øª ÙˆØµÙÙŠØ© Ø´Ø§Ø¦Ø¹Ø© (ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„Ù‡Ø§)
            const descriptors = '(?:unsalted|salted|medium|large|small|extra|all-purpose|purpose|ØºÙŠØ±\\s*Ù…Ù…Ù„Ø­Ø©|Ù…Ù…Ù„Ø­Ø©|ÙƒØ¨ÙŠØ±Ø©|ØµØºÙŠØ±Ø©|Ù…ØªØ¹Ø¯Ø¯\\s*Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ù„Ø§Øª|level)*';
            
            for (const keyword of keywords) {
                const escapedKeyword = escapeRegex(keyword);
                
                // Ù†Ù…Ø· 1: Ø§Ù„Ø±Ù‚Ù… Ù…Ù„ØªØµÙ‚ Ø£Ùˆ Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„ÙˆØ­Ø¯Ø© + ÙƒÙ„Ù…Ø§Øª ÙˆØµÙÙŠØ© Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©
                // Ø£Ù…Ø«Ù„Ø©: "130g Unsalted butter" | "540g All-purpose flour" | "130 Ø¬Ø±Ø§Ù… Ø²Ø¨Ø¯Ø©"
                const pattern1 = new RegExp(
                    `([0-9Ù -Ù©]+(?:[.,Ù«\\/][0-9Ù -Ù©]+)?)\\s*${unitPattern}?\\s*${descriptors}\\s*(?:\\([^)]*\\))?\\s*${escapedKeyword}`,
                    'gi'
                );
                
                // Ù†Ù…Ø· 2: Ø§Ù„Ø±Ù‚Ù… Ø¯Ø§Ø®Ù„ Ø£Ù‚ÙˆØ§Ø³ Ø¨Ø¹Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø© Ø£Ùˆ Ø§Ù„ÙƒÙ„Ù…Ø©
                // Ø£Ù…Ø«Ù„Ø©: "ÙƒÙˆØ¨ (200 Ø¬Ø±Ø§Ù…) Ø³ÙƒØ±" | "baking soda (10 g)"
                const pattern2 = new RegExp(
                    `(?:${unitPattern}\\s*)?${descriptors}?\\s*${escapedKeyword}\\s*(?:[^(]*)?\\(\\s*([0-9Ù -Ù©]+(?:[.,Ù«][0-9Ù -Ù©]+)?)\\s*${unitPattern}?\\s*\\)`,
                    'gi'
                );
                
                // Ù†Ù…Ø· 3: Ø§Ù„Ø±Ù‚Ù… Ø«Ù… (ÙƒÙ„Ù…Ø§Øª ÙˆØµÙÙŠØ©) Ø«Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
                // Ø£Ù…Ø«Ù„Ø©: "3 Ø­Ø¨Ø§Øª Ø¨ÙŠØ¶" | "5 medium eggs" | "2 tsp level baking soda"
                const pattern3 = new RegExp(
                    `([0-9Ù -Ù©]+(?:[.,Ù«\\/][0-9Ù -Ù©]+)?)\\s*${unitPattern}?\\s*${descriptors}\\s*${escapedKeyword}`,
                    'gi'
                );
                
                // Ù†Ù…Ø· 4: Ø§Ù„ÙƒÙ„Ù…Ø© Ø«Ù… Ø§Ù„Ø±Ù‚Ù… ÙÙŠ Ù‚ÙˆØ³
                // Ø£Ù…Ø«Ù„Ø©: "Ø²Ø¨Ø¯Ø© (130 Ø¬Ø±Ø§Ù…)" | "Butter (170g)"
                const pattern4 = new RegExp(
                    `${escapedKeyword}\\s*${descriptors}?\\s*(?:[^(]*)?\\(\\s*([0-9Ù -Ù©]+(?:[.,Ù«][0-9Ù -Ù©]+)?)\\s*${unitPattern}?\\s*\\)`,
                    'gi'
                );
                
                // Ø¬Ø±Ø¨ ÙƒÙ„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨
                const patterns = [pattern2, pattern3, pattern1, pattern4]; // âœ… ØºÙŠØ±Ù†Ø§ Ø§Ù„ØªØ±ØªÙŠØ¨: Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ Ø£ÙˆÙ„Ø§Ù‹
                
                for (const pattern of patterns) {
                    const matches = line.match(pattern);
                    if (matches && matches[0]) {
                        const extracted = extractNumber(matches[0], ingredient, line);
                        if (extracted > 0) {
                            result[ingredient] = extracted;
                            return; // ÙˆØ¬Ø¯Ù†Ø§ Ø§Ù„Ù…ÙƒÙˆÙ†ØŒ ØªÙˆÙ‚Ù
                        }
                    }
                }
            }
        }
		
        /**
         * Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ù†Øµ Ø¨Ø°ÙƒØ§Ø¡ - Ù…ØµØ­Ø­ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
         */
        function extractNumber(text, ingredient, fullLine) {
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† Ø§Ù„Ù†Øµ (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ Ø§Ù„ÙƒØ³ÙˆØ±)
            const numberPattern = /([0-9Ù -Ù©]+(?:[.,Ù«\/][0-9Ù -Ù©]+)?)/g;
            const allNumbers = text.match(numberPattern);
            
            if (!allNumbers || allNumbers.length === 0) return 0;
            
            // ØªØ·Ø¨ÙŠØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØªØ­ÙˆÙŠÙ„Ù‡Ø§
            const normalizedNumbers = allNumbers.map(num => {
                let normalized = normalizeArabicNumbers(num);
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒØ³ÙˆØ± (Ù…Ø«Ù„: 1/2 = 0.5, 3/4 = 0.75)
                if (normalized.includes('/')) {
                    const parts = normalized.split('/');
                    if (parts.length === 2) {
                        const numerator = parseFloat(parts[0]);
                        const denominator = parseFloat(parts[1]);
                        if (!isNaN(numerator) && !isNaN(denominator) && denominator !== 0) {
                            return numerator / denominator;
                        }
                    }
                    return 0;
                }
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ø´Ø±ÙŠØ©
                normalized = normalized.replace(/[,Ù«]/g, '.');
                const parsed = parseFloat(normalized);
                return isNaN(parsed) ? 0 : parsed;
            }).filter(n => n > 0);
            
            if (normalizedNumbers.length === 0) return 0;
            
            // Ù…Ù†Ø·Ù‚ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ Ø­Ø³Ø¨ Ø§Ù„Ù…ÙƒÙˆÙ†
            
            // Ù„Ù„Ø¨ÙŠØ¶: Ù…Ù†Ø·Ù‚ Ø®Ø§Øµ
            if (ingredient === 'eggs') {
                // Ø§Ø¨Ø­Ø« Ø¹Ù† Ø±Ù‚Ù… ØµØºÙŠØ± ÙŠÙ…Ø«Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙŠØ¶Ø§Øª (1-15)
                const eggCount = normalizedNumbers.find(n => n >= 1 && n <= 15 && n === Math.floor(n));
                if (eggCount) {
                    return eggCount * 50; // âœ… Ø¨ÙŠØ¶Ø© = 50 Ø¬Ø±Ø§Ù…
                }
                
                // Ø¥Ø°Ø§ ÙƒÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙƒØ¨ÙŠØ±Ø© (> 15)ØŒ Ø§ÙØªØ±Ø¶ Ø£Ù†Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…Ø§Øª
                const largeNumber = normalizedNumbers.find(n => n > 15);
                if (largeNumber) {
                    return largeNumber;
                }
                
                return Math.max(...normalizedNumbers);
            }
            
            // Ù„Ù„ØµÙˆØ¯Ø§: Ø®Ø° Ø£ØµØºØ± Ø±Ù‚Ù… Ù…Ø¹Ù‚ÙˆÙ„ (Ø§Ù„ØµÙˆØ¯Ø§ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨ÙƒÙ…ÙŠØ§Øª ØµØºÙŠØ±Ø©)
            if (ingredient === 'soda') {
                // Ø§Ù„ØµÙˆØ¯Ø§ Ø¹Ø§Ø¯Ø© 1-20 Ø¬Ø±Ø§Ù…
                const sodaAmount = normalizedNumbers.find(n => n >= 0.5 && n <= 20);
                if (sodaAmount) {
                    return sodaAmount;
                }
                // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø±Ù‚Ù… ØµØºÙŠØ±ØŒ Ø®Ø° Ø£ØµØºØ± Ø±Ù‚Ù…
                return Math.min(...normalizedNumbers);
            }
            
            // Ù„Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰: Ø®Ø° Ø£ÙƒØ¨Ø± Ø±Ù‚Ù… (ØºØ§Ù„Ø¨Ø§Ù‹ Ù‡Ùˆ Ø§Ù„Ø¬Ø±Ø§Ù…Ø§Øª)
            const maxNumber = Math.max(...normalizedNumbers);
            
            // ÙØ­Øµ Ø¥Ø¶Ø§ÙÙŠ: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ (< 1) ÙˆÙ‡Ù†Ø§Ùƒ "ÙƒÙˆØ¨" ÙÙŠ Ø§Ù„Ø³Ø·Ø±
            if (maxNumber < 1 && (fullLine.includes('ÙƒÙˆØ¨') || fullLine.includes('cup'))) {
                return maxNumber * 200; // ÙƒÙˆØ¨ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ = 200 Ø¬Ø±Ø§Ù…
            }
            
            return maxNumber;
        }
    
        /**
         * Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙŠ - Ù…Ø­Ø³Ù‘Ù†
         */
        function displayParsedResults(parsed) {
            const resultsDiv = document.getElementById('parseResults');
            const listDiv = document.getElementById('parsedIngredientsList');
            
            if (!resultsDiv || !listDiv) return;
            
            let html = '<div style="background: white; padding: 10px; border-radius: 8px;">';
            let foundAny = false;
            
            const labels = {
                flour: 'ğŸ¥– Ø¯Ù‚ÙŠÙ‚',
                butter: 'ğŸ§ˆ Ø²Ø¨Ø¯Ø©',
                sugar: 'ğŸ¬ Ø³ÙƒØ±',
                honey: 'ğŸ¯ Ø¹Ø³Ù„',
                eggs: 'ğŸ¥š Ø¨ÙŠØ¶',
                soda: 'ğŸ§ª ØµÙˆØ¯Ø§'
            };
            
            const order = ['flour', 'butter', 'sugar', 'honey', 'eggs', 'soda'];
            
            for (const ingredient of order) {
                const value = parsed[ingredient];
                if (value > 0) {
                    foundAny = true;
                    html += `
                        <div style="padding: 12px; background: #f0f9ff; margin: 8px 0; border-radius: 8px; border-right: 4px solid #3182ce; display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-weight: 600;">${labels[ingredient]}</span>
                            <span style="font-size: 18px; font-weight: 700; color: #3182ce;">${value.toFixed(1)} Ø¬Ù…</span>
                        </div>
                    `;
                }
            }
            
            html += '</div>';
            
            if (!foundAny) {
                html = `
                    <div class="alert alert-danger" style="margin: 15px 0;">
                        <strong>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙƒÙˆÙ†Ø§Øª</strong>
                        <p style="margin-top: 10px; font-size: 0.95em;">ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ù†Øµ. Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©:</p>
                        <ul style="padding-right: 20px; margin: 10px 0; font-size: 0.9em;">
                            <li>200 Ø¬Ø±Ø§Ù… Ø²Ø¨Ø¯Ø©</li>
                            <li>ÙƒÙˆØ¨ (150Øº) Ø³ÙƒØ±</li>
                            <li>3/4 ÙƒÙˆØ¨ Ø¯Ù‚ÙŠÙ‚</li>
                            <li>3 Ø¨ÙŠØ¶Ø§Øª</li>
                            <li>170 gr Butter</li>
                            <li>5 eggs</li>
                        </ul>
                    </div>
                `;
            }
            
            listDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
            window.lastParsedRecipe = parsed;
        }
    
        /**
         * ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØµÙØ© Ø§Ù„Ù…Ø­Ù„Ù„Ø©
         */
        function applyParsedRecipe() {
            if (!window.lastParsedRecipe) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØµÙØ© Ù…Ø­Ù„Ù„Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚');
                return;
            }
            
            const parsed = window.lastParsedRecipe;
            
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (flourInput) flourInput.value = parsed.flour || 0;
            if (butterInput) butterInput.value = parsed.butter || 0;
            if (sugarInput) sugarInput.value = parsed.sugar || 0;
            if (honeyInput) honeyInput.value = parsed.honey || 0;
            if (eggsInput) eggsInput.value = parsed.eggs || 0;
            if (sodaInput) sodaInput.value = parsed.soda || 0;
            
            analyzeRecipe();
            alert('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØµÙØ© Ø¨Ù†Ø¬Ø§Ø­!');
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const resultBox = document.getElementById('analysis-result');
            if (resultBox) {
                resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }
    
        /**
         * Ø­ÙØ¸ Ø§Ù„ÙˆØµÙØ© Ø§Ù„Ù…Ø­Ù„Ù„Ø©
         */
        function saveParsedRecipe() {
            if (!window.lastParsedRecipe) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØµÙØ© Ù…Ø­Ù„Ù„Ø© Ù„Ù„Ø­ÙØ¸');
                return;
            }
            
            const name = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ù„Ù„ÙˆØµÙØ©:', `ÙˆØµÙØ© ${new Date().toLocaleDateString('ar-EG')}`);
            if (!name || name.trim() === '') return;
            
            const recipeToSave = {
                name: name.trim(),
                ...window.lastParsedRecipe,
                timestamp: new Date().toISOString(),
                source: 'text_parser'
            };
            
            savedRecipes.push(recipeToSave);
            saveRecipesToStorage();
            
            alert(`âœ… ØªÙ… Ø­ÙØ¸ "${name}" Ø¨Ù†Ø¬Ø§Ø­!`);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
            const feedbackDiv = document.getElementById('recipeFeedback');
            if (feedbackDiv) {
                feedbackDiv.style.display = 'block';
            }
            
            updateLibraryTab();
        }
    
        /**
         * Ù…Ø³Ø­ Ø§Ù„Ù†Øµ
         */
        function clearText() {
            const textArea = document.getElementById('recipeText');
            const resultsDiv = document.getElementById('parseResults');
            
            if (textArea) textArea.value = '';
            if (resultsDiv) resultsDiv.style.display = 'none';
            
            window.lastParsedRecipe = null;
        }
    
        // ===== Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø§Ù„Ù…ØµØ­Ø­ =====
        
        function initAdvancedScaling() {
            const modeButtons = document.querySelectorAll('.btn-mode');
            const calculateBtn = document.getElementById('calculateAdvanced');
            const applyBtn = document.getElementById('applyAdvancedResults');
            
            modeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    modeButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const mode = this.getAttribute('data-mode');
                    const basicContent = document.getElementById('basicScalingContent');
                    const advancedContent = document.getElementById('advancedScalingContent');
                    
                    if (basicContent && advancedContent) {
                        basicContent.classList.toggle('active', mode === 'basic');
                        advancedContent.classList.toggle('active', mode === 'advanced');
                    }
                });
            });
            
            if (calculateBtn) {
                calculateBtn.addEventListener('click', calculateAdvancedScaling);
            }
            
            if (applyBtn) {
                applyBtn.addEventListener('click', applyAdvancedResults);
            }
        }
    
        /**
         * Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - Ù…ØµØ­Ø­
         */
        function calculateAdvancedScaling() {
            if (!currentRecipe) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ­Ù„ÙŠÙ„ ÙˆØµÙØ© Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ');
                return;
            }
            
            const targetLayersInput = document.getElementById('targetLayers');
            const layerWeightInput = document.getElementById('layerWeight');
            const extraPercentageInput = document.getElementById('extraPercentage');
            
            if (!targetLayersInput || !layerWeightInput || !extraPercentageInput) return;
            
            const targetLayers = parseInt(targetLayersInput.value) || 7;
            const layerWeight = parseInt(layerWeightInput.value) || 150;
            const extraPercentage = parseInt(extraPercentageInput.value) || 12;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (targetLayers < 1 || targetLayers > 20) {
                alert('âŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ 20');
                return;
            }
            
            if (layerWeight < 50 || layerWeight > 300) {
                alert('âŒ ÙˆØ²Ù† Ø§Ù„Ø·Ø¨Ù‚Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 50 Ùˆ 300 Ø¬Ø±Ø§Ù…');
                return;
            }
            
            const cakeWeight = targetLayers * layerWeight;
            const extraWeight = cakeWeight * (extraPercentage / 100);
            const totalWeight = cakeWeight + extraWeight;
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù†Ø®ÙØ¶Ø©
            let ratios = {
                flourPct: currentRecipe.flourPct,
                butterPct: currentRecipe.butterPct,
                sugarPct: currentRecipe.sugarPct,
                honeyPct: currentRecipe.honeyPct,
                eggsPct: currentRecipe.eggsPct,
                sodaPct: currentRecipe.sodaPct
            };
            
            let useIdealRatios = false;
            if (currentAnalysis && currentAnalysis.qualityScore < 60) {
                const confirm = window.confirm(
                    `ÙˆØµÙØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¬ÙˆØ¯ØªÙ‡Ø§ ${currentAnalysis.qualityScore}/100.\n\n` +
                    'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¹Ù„Ù…ÙŠØ§Ù‹ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ\n\n' +
                    'Ù†Ø¹Ù… = Ù†Ø³Ø¨ Ù…Ø«Ø§Ù„ÙŠØ© Ù…Ø¶Ù…ÙˆÙ†Ø©\n' +
                    'Ù„Ø§ = Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù†Ø³Ø¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©'
                );
                
                if (confirm) {
                    ratios = {
                        flourPct: SCIENTIFIC_RANGES.flour.ideal,
                        butterPct: SCIENTIFIC_RANGES.butter.ideal,
                        sugarPct: 15,
                        honeyPct: 15.5,
                        eggsPct: SCIENTIFIC_RANGES.eggs.ideal,
                        sodaPct: SCIENTIFIC_RANGES.soda.ideal
                    };
                    useIdealRatios = true;
                }
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨
            const flour = (ratios.flourPct / 100) * totalWeight;
            const butter = (ratios.butterPct / 100) * totalWeight;
            const sugar = (ratios.sugarPct / 100) * totalWeight;
            const honey = (ratios.honeyPct / 100) * totalWeight;
            const eggs = (ratios.eggsPct / 100) * totalWeight;
            const soda = (ratios.sodaPct / 100) * totalWeight;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const resultsDiv = document.getElementById('advancedResults');
            const calcDiv = document.getElementById('advancedCalculations');
            
            if (!resultsDiv || !calcDiv) return;
            
            calcDiv.innerHTML = `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4 style="color: #3182ce; margin-bottom: 10px;">ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h4>
                    <p><strong>Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø¹Ø¬ÙŠÙ†Ø©:</strong> ${totalWeight.toFixed(1)} Ø¬Ù…</p>
                    <p><strong>ÙˆØ²Ù† Ø§Ù„ÙƒÙŠÙƒ Ø§Ù„ÙØ¹Ù„ÙŠ:</strong> ${cakeWeight.toFixed(1)} Ø¬Ù… (${targetLayers} Ø·Ø¨Ù‚Ø§Øª Ã— ${layerWeight}Ø¬Ù…)</p>
                    <p><strong>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„Ù„Ø·Ø­Ù†:</strong> ${extraWeight.toFixed(1)} Ø¬Ù… (${extraPercentage}%)</p>
                </div>
                
                <hr style="margin: 20px 0; border: none; border-top: 2px solid #e2e8f0;">
                
                <h4 style="color: #2d3748; margin-bottom: 15px;">ğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h4>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¯Ù‚ÙŠÙ‚:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${flour.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.flourPct.toFixed(1)}%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø²Ø¨Ø¯Ø©:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${butter.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.butterPct.toFixed(1)}%</td>
                    </tr>
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø³ÙƒØ±:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${sugar.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.sugarPct.toFixed(1)}%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¹Ø³Ù„:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${honey.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.honeyPct.toFixed(1)}%</td>
                    </tr>
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¨ÙŠØ¶:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${eggs.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.eggsPct.toFixed(1)}%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>ØµÙˆØ¯Ø§:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${soda.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">${ratios.sodaPct.toFixed(2)}%</td>
                    </tr>
                </table>
                
                ${useIdealRatios ? `
                    <div class="alert alert-success" style="margin-top: 15px;">
                        âœ… <strong>ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¹Ù„Ù…ÙŠØ§Ù‹</strong><br>
                        Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø£Ø¨Ø­Ø§Ø« Ø¹Ù„Ù…ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬.
                    </div>
                ` : ''}
            `;
            
            resultsDiv.style.display = 'block';
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¤Ù‚ØªØ§Ù‹
            window.advancedResults = { 
                flour, 
                butter, 
                sugar, 
                honey, 
                eggs, 
                soda, 
                totalWeight,
                usedIdealRatios: useIdealRatios
            };
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    
        /**
         * ØªØ·Ø¨ÙŠÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
         */
        function applyAdvancedResults() {
            if (!window.advancedResults) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚. Ù‚Ù… Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹.');
                return;
            }
            
            const results = window.advancedResults;
            
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (flourInput) flourInput.value = results.flour.toFixed(1);
            if (butterInput) butterInput.value = results.butter.toFixed(1);
            if (sugarInput) sugarInput.value = results.sugar.toFixed(1);
            if (honeyInput) honeyInput.value = results.honey.toFixed(1);
            if (eggsInput) eggsInput.value = results.eggs.toFixed(1);
            if (sodaInput) sodaInput.value = results.soda.toFixed(1);
            
            analyzeRecipe();
            alert('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³ÙƒÙŠÙ„Ù†Ø¬ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…!');
            
            // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„
            const analyzerTab = document.querySelector('[data-tab="analyzer"]');
            if (analyzerTab) {
                analyzerTab.click();
            }
        }
    
        // ===== Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ© Ø§Ù„Ù…ØµØ­Ø­Ø© =====
        
        function initReverseCalculator() {
            const calculateBtn = document.getElementById('calculateReverse');
            const applyBtn = document.getElementById('applyReverseResults');
            
            if (calculateBtn) {
                calculateBtn.addEventListener('click', calculateReverseScaling);
            }
            
            if (applyBtn) {
                applyBtn.addEventListener('click', applyReverseResults);
            }
        }
    
        /**
         * Ø­Ø³Ø§Ø¨ Ø¹ÙƒØ³ÙŠ Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª - Ù…ØµØ­Ø­
         */
        function calculateReverseScaling() {
            const targetLayersInput = document.getElementById('targetLayersReverse');
            const layerDiameterInput = document.getElementById('layerDiameter');
            const layerThicknessInput = document.getElementById('layerThickness');
            
            if (!targetLayersInput || !layerDiameterInput || !layerThicknessInput) return;
            
            const targetLayers = parseInt(targetLayersInput.value) || 7;
            const layerDiameter = parseFloat(layerDiameterInput.value) || 24;
            const layerThickness = parseFloat(layerThicknessInput.value) || 2;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (targetLayers < 1 || targetLayers > 20) {
                alert('âŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ 20');
                return;
            }
            
            if (layerDiameter < 10 || layerDiameter > 40) {
                alert('âŒ Ù‚Ø·Ø± Ø§Ù„Ø·Ø¨Ù‚Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 10 Ùˆ 40 Ø³Ù…');
                return;
            }
            
            if (layerThickness < 1 || layerThickness > 5) {
                alert('âŒ Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø·Ø¨Ù‚Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ 5 Ù…Ù„Ù…');
                return;
            }
            
            // Ø­Ø³Ø§Ø¨ ÙˆØ²Ù† Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©
            const radius = layerDiameter / 2;
            const area = Math.PI * Math.pow(radius, 2); // Ø³Ù…Â²
            const volume = area * (layerThickness / 10); // ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ù…Ù„Ù… Ø¥Ù„Ù‰ Ø³Ù…
            const layerWeight = volume * DOUGH_DENSITY; // ØºØ±Ø§Ù…
            
            // Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„ÙƒÙŠÙƒ
            const cakeWeight = targetLayers * layerWeight;
            
            // Ø¥Ø¶Ø§ÙØ© ÙØ§Ù‚Ø¯ (12% ÙØ§Ù‚Ø¯ Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙØ±Ø¯ ÙˆØ§Ù„Ù‚Øµ)
            const wastage = 0.12;
            const totalWeight = cakeWeight * (1 + wastage);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø¨Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©
            const flour = totalWeight * 0.50;
            const butter = totalWeight * 0.12;
            const sugar = totalWeight * 0.15;
            const honey = totalWeight * 0.155;
            const eggs = totalWeight * 0.095;
            const soda = totalWeight * 0.0055;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const resultsDiv = document.getElementById('reverseResults');
            const calcDiv = document.getElementById('reverseCalculations');
            
            if (!resultsDiv || !calcDiv) return;
            
            calcDiv.innerHTML = `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4 style="color: #3182ce; margin-bottom: 10px;">ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:</h4>
                    <p><strong>Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø¹Ø¬ÙŠÙ†Ø©:</strong> ${totalWeight.toFixed(1)} Ø¬Ù…</p>
                    <p><strong>ÙˆØ²Ù† Ø§Ù„ÙƒÙŠÙƒ Ø§Ù„ÙØ¹Ù„ÙŠ:</strong> ${cakeWeight.toFixed(1)} Ø¬Ù… (${targetLayers} Ø·Ø¨Ù‚Ø§Øª)</p>
                    <p><strong>Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙØ§Ù‚Ø¯:</strong> ${(cakeWeight * wastage).toFixed(1)} Ø¬Ù… (${(wastage * 100).toFixed(0)}%)</p>
                </div>
                
                <hr style="margin: 20px 0; border: none; border-top: 2px solid #e2e8f0;">
                
                <h4 style="color: #2d3748; margin-bottom: 15px;">ğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h4>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¯Ù‚ÙŠÙ‚:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${flour.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">50%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø²Ø¨Ø¯Ø©:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${butter.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">12%</td>
                    </tr>
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø³ÙƒØ±:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${sugar.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">15%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¹Ø³Ù„:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${honey.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">15.5%</td>
                    </tr>
                    <tr style="background: #f7fafc;">
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>Ø¨ÙŠØ¶:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${eggs.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">9.5%</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;"><strong>ØµÙˆØ¯Ø§:</strong></td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0;">${soda.toFixed(1)} Ø¬Ù…</td>
                        <td style="padding: 10px; border: 1px solid #e2e8f0; color: #718096;">0.55%</td>
                    </tr>
                </table>
                
                <div class="alert alert-info" style="margin-top: 15px;">
                    <strong>ğŸ“ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø¨Ù‚Ø©:</strong>
                    <ul style="margin: 10px 0; padding-right: 20px;">
                        <li>Ù‚Ø·Ø± Ø§Ù„Ø·Ø¨Ù‚Ø©: ${layerDiameter} Ø³Ù…</li>
                        <li>Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø·Ø¨Ù‚Ø©: ${layerThickness} Ù…Ù„Ù…</li>
                        <li>ÙˆØ²Ù† Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©: ${layerWeight.toFixed(1)} Ø¬Ù…</li>
                        <li>Ø­Ø¬Ù… Ø§Ù„Ø·Ø¨Ù‚Ø©: ${volume.toFixed(1)} Ø³Ù…Â³</li>
                    </ul>
                </div>
                
                <div class="alert alert-success" style="margin-top: 10px;">
                    âœ… <strong>ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¹Ù„Ù…ÙŠØ§Ù‹</strong><br>
                    Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ ÙƒØ«Ø§ÙØ© ${DOUGH_DENSITY} Ø¬Ù…/Ø³Ù…Â³
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¤Ù‚ØªØ§Ù‹
            window.reverseResults = { 
                flour, 
                butter, 
                sugar, 
                honey, 
                eggs, 
                soda, 
                totalWeight 
            };
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    
        /**
         * ØªØ·Ø¨ÙŠÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ©
         */
        function applyReverseResults() {
            if (!window.reverseResults) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚. Ù‚Ù… Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹.');
                return;
            }
            
            const results = window.reverseResults;
            
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (flourInput) flourInput.value = results.flour.toFixed(1);
            if (butterInput) butterInput.value = results.butter.toFixed(1);
            if (sugarInput) sugarInput.value = results.sugar.toFixed(1);
            if (honeyInput) honeyInput.value = results.honey.toFixed(1);
            if (eggsInput) eggsInput.value = results.eggs.toFixed(1);
            if (sodaInput) sodaInput.value = results.soda.toFixed(1);
            
            analyzeRecipe();
            alert('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ©!');
            
            // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„
            const analyzerTab = document.querySelector('[data-tab="analyzer"]');
            if (analyzerTab) {
                analyzerTab.click();
            }
        }
    
        // ===== Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ù…ØµØ­Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ =====
        
        function initTemperingCalculator() {
            const calculateBtn = document.getElementById('calculateTempering');
            const autoFillBtn = document.getElementById('autoFill');
            
            if (calculateBtn) {
                calculateBtn.addEventListener('click', calculateTempering);
            }
            
            if (autoFillBtn) {
                autoFillBtn.addEventListener('click', autoFillFromRecipe);
            }
        }
    
        /**
         * Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ - Ù…ØµØ­Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
         */
        function calculateTempering() {
            const eggMassInput = document.getElementById('eggMass');
            const eggTempInput = document.getElementById('eggTemp');
            const liquidMassInput = document.getElementById('liquidMass');
            const liquidTempInput = document.getElementById('liquidTemp');
            const batchCountInput = document.getElementById('batchCount');
            
            if (!eggMassInput || !eggTempInput || !liquidMassInput || !liquidTempInput || !batchCountInput) {
                alert('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            const eggMass = parseFloat(eggMassInput.value);
            const eggTemp = parseFloat(eggTempInput.value);
            const liquidMass = parseFloat(liquidMassInput.value);
            const liquidTemp = parseFloat(liquidTempInput.value);
            const batchCount = parseInt(batchCountInput.value);
    
            // ØªØ­Ù‚Ù‚ Ù…Ø­Ø³Ù‘Ù† Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (isNaN(eggMass) || isNaN(eggTemp) || isNaN(liquidMass) || isNaN(liquidTemp) || isNaN(batchCount)) {
                alert('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø±Ù‚Ø§Ù… ØµØ­ÙŠØ­Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            if (eggMass <= 0 || liquidMass <= 0) {
                alert('âŒ Ø§Ù„ÙƒØªÙ„Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
                return;
            }
            
            if (eggTemp < 0 || eggTemp > 30) {
                alert('âŒ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¶ ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠØ©!\nÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 0-30Â°C');
                return;
            }
            
            if (liquidTemp < 60 || liquidTemp > 120) {
                alert('âŒ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø®Ù„ÙŠØ· ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠØ©!\nÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 60-120Â°C');
                return;
            }
            
            if (batchCount < 2 || batchCount > 10) {
                alert('âŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 2 Ùˆ 10');
                return;
            }
    
            const batches = calculateOptimalBatches(eggMass, eggTemp, liquidMass, liquidTemp, batchCount);
            displayTemperingResults(batches, eggMass, eggTemp, liquidMass, liquidTemp);
        }
    
        /**
         * Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù…Ø«Ù„Ù‰ - Ù…ØµØ­Ø­ ÙˆÙ…Ø­Ø³Ù‘Ù†
         */
        function calculateOptimalBatches(eggMass, eggTemp, liquidMass, liquidTemp, batchCount) {
            const batches = [];
            let currentMass = eggMass;
            let currentTemp = eggTemp;
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ²ÙŠØ¹
            const distribution = getBatchDistribution(batchCount);
            
            // Ø¶Ù…Ø§Ù† Ø£Ù† Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø§Øª = 100% Ø¨Ø§Ù„Ø¶Ø¨Ø·
            const totalDistributed = distribution.reduce((sum, p) => sum + p, 0);
            if (Math.abs(totalDistributed - 100) > 0.001) {
                distribution[distribution.length - 1] += 100 - totalDistributed;
            }
            
            // Ø­Ø³Ø§Ø¨ ÙƒØªÙ„ Ø§Ù„Ø¯ÙØ¹Ø§Øª
            const batchMasses = distribution.map(percentage => (percentage / 100) * liquidMass);
            
            distribution.forEach((percentage, index) => {
                let batchMass;
                
                // Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ØªØ£Ø®Ø° Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø¨Ø§Ù„Ø¶Ø¨Ø· Ù„ØªØ¬Ù†Ø¨ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨
                if (index === distribution.length - 1) {
                    const previousMass = batches.reduce((sum, b) => sum + b.mass, 0);
                    batchMass = liquidMass - previousMass;
                } else {
                    batchMass = batchMasses[index];
                }
                
                // Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© Ø§Ù„ØµØ­ÙŠØ­Ø©: Conservation of Energy
                const newTemp = (currentMass * currentTemp + batchMass * liquidTemp) / (currentMass + batchMass);
                
                batches.push({
                    batchNumber: index + 1,
                    mass: parseFloat(batchMass.toFixed(2)),
                    percentage: percentage,
                    tempBefore: parseFloat(currentTemp.toFixed(1)),
                    tempAfter: parseFloat(newTemp.toFixed(1)),
                    totalMass: parseFloat((currentMass + batchMass).toFixed(2))
                });
                
                currentMass += batchMass;
                currentTemp = newTemp;
            });
            
            return batches;
        }
    
        /**
         * ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¯ÙØ¹Ø§Øª - Ù…ØµØ­Ø­ Ù…Ø¹ Ø¯Ø¹Ù… Ø£ÙŠ Ø¹Ø¯Ø¯
         */
        function getBatchDistribution(batchCount) {
            // ØªÙˆØ²ÙŠØ¹Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
            const distributions = {
                2: [55, 45],
                3: [40, 35, 25],
                4: [30, 30, 25, 15],
                5: [25, 25, 20, 15, 15],
                6: [20, 20, 20, 15, 15, 10],
                7: [18, 17, 16, 15, 14, 12, 8],
                8: [15, 15, 14, 13, 12, 11, 10, 10],
                9: [13, 13, 12, 12, 11, 11, 10, 9, 9],
                10: [12, 12, 11, 11, 10, 10, 9, 9, 8, 8]
            };
            
            if (distributions[batchCount]) {
                return distributions[batchCount];
            }
            
            // ØªÙˆÙ„ÙŠØ¯ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù„Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø®Ø±Ù‰
            const base = Math.floor(100 / batchCount);
            const remainder = 100 - (base * batchCount);
            const dist = Array(batchCount).fill(base);
            
            // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰
            for (let i = 0; i < remainder; i++) {
                dist[i]++;
            }
            
            return dist;
        }
    
        /**
         * Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ - Ù…Ø­Ø³Ù‘Ù†
         */
        function displayTemperingResults(batches, eggMass, eggTemp, liquidMass, liquidTemp) {
            const finalTemp = batches[batches.length - 1].tempAfter;
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø­Ø±Ø§Ø±ÙŠ
            let progressionHTML = `<div class="timeline-temp ${finalTemp > 68 ? 'danger' : finalTemp > 65 ? 'warning' : 'success'}">`;
            progressionHTML += `ğŸŒ¡ï¸ Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø­Ø±Ø§Ø±ÙŠ: `;
            
            batches.forEach((batch, index) => {
                if (index === 0) {
                    progressionHTML += `${batch.tempBefore}Â°C â†’ `;
                }
                progressionHTML += `${batch.tempAfter}Â°C`;
                if (index < batches.length - 1) progressionHTML += ' â†’ ';
            });
            progressionHTML += `</div>`;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© (Ù„Ù„ØªØ­Ù‚Ù‚)
            const theoreticalFinal = (eggMass * eggTemp + liquidMass * liquidTemp) / (eggMass + liquidMass);
            
            // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙØ¹Ø§Øª
            let batchesHTML = `
                <h5 style="margin-top: 20px;">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø§Øª:</h5>
                <div class="alert alert-info">
                    <strong>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©: ${theoreticalFinal.toFixed(1)}Â°C</strong> 
                    <span style="font-size: 0.9em; color: #718096;">(Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ)</span>
                    ${Math.abs(theoreticalFinal - finalTemp) < 0.5 ? 
                        '<br><span style="color: #38a169;">âœ… Ø§Ù„ØªØ·Ø§Ø¨Ù‚ Ù…Ù…ØªØ§Ø² Ù…Ø¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠØ©</span>' : 
                        '<br><span style="color: #d69e2e;">âš ï¸ ÙØ±Ù‚ Ø·ÙÙŠÙ Ø¨Ø³Ø¨Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨</span>'
                    }
                </div>
                <table style="width: 100%; margin-top: 10px;">
                    <tr>
                        <th>Ø§Ù„Ø¯ÙØ¹Ø©</th>
                        <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                        <th>Ø§Ù„Ù†Ø³Ø¨Ø©</th>
                        <th>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ù‚Ø¨Ù„</th>
                        <th>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø¨Ø¹Ø¯</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    </tr>
            `;
            
            batches.forEach(batch => {
                let status, statusText, statusClass;
                
                if (batch.tempAfter > 68) {
                    status = 'âŒ';
                    statusText = 'Ø®Ø·ÙŠØ±';
                    statusClass = 'score-low';
                } else if (batch.tempAfter > 65) {
                    status = 'âš ï¸';
                    statusText = 'ØªØ­Ø°ÙŠØ±';
                    statusClass = 'score-medium';
                } else {
                    status = 'âœ…';
                    statusText = 'Ø¢Ù…Ù†';
                    statusClass = 'score-high';
                }
                
                batchesHTML += `<tr>
                    <td>Ø§Ù„Ø¯ÙØ¹Ø© ${batch.batchNumber}</td>
                    <td>${batch.mass.toFixed(1)}Øº</td>
                    <td>${batch.percentage}%</td>
                    <td>${batch.tempBefore}Â°C</td>
                    <td>${batch.tempAfter}Â°C</td>
                    <td class="${statusClass}">${status} ${statusText}</td>
                </tr>`;
            });
            batchesHTML += '</table>';
            
            // Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª ÙˆØ§Ù„Ø­Ù„ÙˆÙ„
            let warningsHTML = '';
            
            if (finalTemp > 68) {
                warningsHTML = `
                    <div class="alert alert-danger">
                        <strong>ğŸš« Ø®Ø·Ø± Ø§Ù„ØªØ®Ø«Ø±!</strong> Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ${finalTemp.toFixed(1)}Â°C ØªØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† 68Â°C
                        <br><strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª <strong>Ù„Ù† ØªØ®ÙØ¶</strong> Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
                    </div>
                    ${getPracticalSolutions(eggMass, eggTemp, liquidMass, liquidTemp, finalTemp)}
                `;
            } else if (finalTemp > 65) {
                warningsHTML = `
                    <div class="alert alert-warning">
                        <strong>âš ï¸ ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±!</strong> Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ${finalTemp.toFixed(1)}Â°C Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¢Ù…Ù†
                        <br>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø«Ø§Ø¨ØªØ© Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª
                    </div>
                    ${getPracticalSolutions(eggMass, eggTemp, liquidMass, liquidTemp, finalTemp)}
                `;
            } else {
                warningsHTML = `
                    <div class="alert alert-success">
                        <strong>âœ… Ø¢Ù…Ù† ØªÙ…Ø§Ù…Ø§Ù‹!</strong> Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ${finalTemp.toFixed(1)}Â°C Ø¶Ù…Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¢Ù…Ù†
                        <div style="margin-top: 10px;">
                            <strong>Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø«Ù„Ù‰:</strong>
                            <ul style="margin: 10px 0; padding-right: 20px;">
                                <li>Ø£Ø¶Ù ÙƒÙ„ Ø¯ÙØ¹Ø© Ø¨Ø¨Ø·Ø¡ Ù…Ø¹ Ø§Ù„Ø®ÙÙ‚ Ø§Ù„Ù…Ø³ØªÙ…Ø±</li>
                                <li>ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¬Ø§Ù†Ø³ Ø§Ù„Ø®Ù„ÙŠØ· Ø¨Ø¹Ø¯ ÙƒÙ„ Ø¯ÙØ¹Ø©</li>
                                <li>Ù„Ø§ ØªØ¹ÙŠØ¯ Ø§Ù„ØªØ³Ø®ÙŠÙ† Ø¨Ø¹Ø¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ¶</li>
                                <li>Ø§Ø³ØªØ®Ø¯Ù… ØªØ±Ù…ÙˆÙ…ØªØ± Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const progressionDiv = document.getElementById('temperatureProgression');
            const batchDetailsDiv = document.getElementById('batchDetails');
            const warningsDiv = document.getElementById('safetyWarnings');
            const resultsDiv = document.getElementById('temperingResults');
            
            if (progressionDiv) progressionDiv.innerHTML = progressionHTML;
            if (batchDetailsDiv) batchDetailsDiv.innerHTML = batchesHTML;
            if (warningsDiv) warningsDiv.innerHTML = warningsHTML;
            if (resultsDiv) resultsDiv.style.display = 'block';
            
            updateTemperatureVisualization(batches);
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            if (resultsDiv) {
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }
    
        /**
         * Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© - Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© Ø§Ù„ØµØ­ÙŠØ­Ø©
         */
        function getPracticalSolutions(eggMass, eggTemp, liquidMass, liquidTemp, finalTemp) {
            const T_SAFE = 66; // Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©
            
            // Ø§Ù„Ø­Ù„ 1: Ø£Ù‚ØµÙ‰ ÙƒØªÙ„Ø© Ø³Ø§Ø®Ù†Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©
            const maxMass = maxHotMassForTarget(eggMass, eggTemp, liquidTemp, T_SAFE);
            
            // Ø§Ù„Ø­Ù„ 2: Ø£Ù‚ØµÙ‰ Ø­Ø±Ø§Ø±Ø© Ù„Ù„Ø®Ù„ÙŠØ· Ø§Ù„Ø³Ø§Ø®Ù†
            const maxTemp = maxHotTempForTarget(eggMass, eggTemp, liquidMass, T_SAFE);
            
            // Ø§Ù„Ø­Ù„ 3: Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ¶ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const eggIncrease = neededEggIncrease(eggMass, eggTemp, liquidMass, liquidTemp, T_SAFE);
            
            let solutionsHTML = `
                <div class="alert alert-info" style="margin-top: 15px;">
                    <strong>ğŸ’¡ Ù„Ù…Ø§Ø°Ø§ ØªØ¸Ù„ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø«Ø§Ø¨ØªØ©ØŸ</strong><br>
                    Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ <strong>Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</strong> ÙˆÙ„ÙŠØ³ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª.
                    Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯ÙØ¹Ø§Øª ØªØ­Ø³Ù† Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ù…Ø±Ø­Ù„ÙŠ Ù„ÙƒÙ† <strong>Ù„Ø§ ØªØºÙŠØ± Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</strong>.
                </div>
                
                <div class="alert alert-warning">
                    <strong>ğŸ¯ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø®ÙØ¶ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø¥Ù„Ù‰ ${T_SAFE}Â°C:</strong>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 15px 0;">
            `;
            
            // Ø§Ù„Ø­Ù„ 1: ØªÙ‚Ù„ÙŠÙ„ ÙƒØªÙ„Ø© Ø§Ù„Ø®Ù„ÙŠØ· Ø§Ù„Ø³Ø§Ø®Ù†
            solutionsHTML += `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-right: 4px solid #3182ce;">
                    <h4 style="color: #3182ce; margin-bottom: 10px;">ğŸ“‰ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ÙƒØªÙ„Ø©</h4>
                    <p><strong>Ø®Ù Ø§Ù„ÙƒØªÙ„Ø© Ø¥Ù„Ù‰:</strong></p>
                    <p style="font-size: 18px; font-weight: bold; color: #3182ce; margin: 10px 0;">${maxMass.toFixed(1)} Øº</p>
                    <small style="color: #718096;">Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ${liquidMass.toFixed(1)} Øº</small>
                    <button class="btn" style="margin-top: 8px; background: #3182ce; color: white; width: 100%; padding: 8px;" onclick="applyMassSolution(${maxMass.toFixed(1)})">ØªØ·Ø¨ÙŠÙ‚</button>
                </div>
            `;
            
            // Ø§Ù„Ø­Ù„ 2: Ø®ÙØ¶ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©
            solutionsHTML += `
                <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-right: 4px solid #38a169;">
                    <h4 style="color: #38a169; margin-bottom: 10px;">ğŸŒ¡ï¸ Ø®ÙØ¶ Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h4>
                    <p><strong>Ø¨Ø±Ø¯ Ø§Ù„Ø®Ù„ÙŠØ· Ø¥Ù„Ù‰:</strong></p>
                    <p style="font-size: 18px; font-weight: bold; color: #38a169; margin: 10px 0;">${maxTemp.toFixed(1)}Â°C</p>
                    <small style="color: #718096;">Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ${liquidTemp.toFixed(1)}Â°C</small>
                    <button class="btn" style="margin-top: 8px; background: #38a169; color: white; width: 100%; padding: 8px;" onclick="applyTempSolution(${maxTemp.toFixed(1)})">ØªØ·Ø¨ÙŠÙ‚</button>
                </div>
            `;
            
            // Ø§Ù„Ø­Ù„ 3: Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ¶
            const newEggMass = eggMass + Math.max(0, eggIncrease);
            solutionsHTML += `
                <div style="background: #fffaf0; padding: 15px; border-radius: 8px; border-right: 4px solid #d69e2e;">
                    <h4 style="color: #d69e2e; margin-bottom: 10px;">ğŸ¥š Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ¶</h4>
                    <p><strong>Ø£Ø¶Ù Ø¨ÙŠØ¶Ø§Ù‹:</strong></p>
                    <p style="font-size: 18px; font-weight: bold; color: #d69e2e; margin: 10px 0;">+${Math.max(0, eggIncrease).toFixed(1)} Øº</p>
                    <small style="color: #718096;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${newEggMass.toFixed(1)} Øº</small>
                    <button class="btn" style="margin-top: 8px; background: #d69e2e; color: white; width: 100%; padding: 8px;" onclick="applyEggSolution(${newEggMass.toFixed(1)})">ØªØ·Ø¨ÙŠÙ‚</button>
                </div>
            `;
            
            solutionsHTML += `</div>`;
            
            // Ø´Ø±Ø­ Ø¥Ø¶Ø§ÙÙŠ
            solutionsHTML += `
                <div class="alert alert-success">
                    <strong>ğŸ“š Ù…Ù„Ø§Ø­Ø¸Ø© Ø¹Ù„Ù…ÙŠØ©:</strong>
                    <ul style="margin: 10px 0; padding-right: 20px; font-size: 0.95em;">
                        <li>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© = (Ø§Ù„ÙƒØªÙ„Ø©â‚ Ã— Ø§Ù„Ø­Ø±Ø§Ø±Ø©â‚ + Ø§Ù„ÙƒØªÙ„Ø©â‚‚ Ã— Ø§Ù„Ø­Ø±Ø§Ø±Ø©â‚‚) Ã· (Ø§Ù„ÙƒØªÙ„Ø©â‚ + Ø§Ù„ÙƒØªÙ„Ø©â‚‚)</li>
                        <li>Ù„Ø®ÙØ¶ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©ØŒ ÙŠØ¬Ø¨ ØªØºÙŠÙŠØ± Ø£Ø­Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø¹Ø©</li>
                        <li>Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ <strong>Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ù…Ø±Ø­Ù„ÙŠ</strong> ÙÙ‚Ø· ÙˆÙ„ÙŠØ³ Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</li>
                    </ul>
                </div>
            `;
            
            return solutionsHTML;
        }
    
        /**
         * Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© - ØµØ­ÙŠØ­Ø© 100%
         */
        
        // Ø­Ø³Ø§Ø¨ Ø£Ù‚ØµÙ‰ ÙƒØªÙ„Ø© Ø³Ø§Ø®Ù†Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø­Ø±Ø§Ø±Ø© Ù…Ø³ØªÙ‡Ø¯ÙØ©
        function maxHotMassForTarget(M0, T0, tHot, Ttarget) {
            if (tHot <= Ttarget) return Infinity;
            if (Ttarget <= T0) return 0;
            return (M0 * (Ttarget - T0)) / (tHot - Ttarget);
        }
    
        // Ø­Ø³Ø§Ø¨ Ø£Ù‚ØµÙ‰ Ø­Ø±Ø§Ø±Ø© Ù„Ù„Ø®Ù„ÙŠØ· Ø§Ù„Ø³Ø§Ø®Ù† Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø­Ø±Ø§Ø±Ø© Ù…Ø³ØªÙ‡Ø¯ÙØ©
        function maxHotTempForTarget(M0, T0, Mhot, Ttarget) {
            if (Mhot <= 0) return Infinity;
            const result = (Ttarget * (M0 + Mhot) - M0 * T0) / Mhot;
            return Math.max(T0, result); // Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        }
    
        // Ø­Ø³Ø§Ø¨ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ¶ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø­Ø±Ø§Ø±Ø© Ù…Ø³ØªÙ‡Ø¯ÙØ©
        function neededEggIncrease(eggMass, eggTemp, liquidMass, liquidTemp, Ttarget) {
            if (Ttarget <= eggTemp) return 0;
            if (liquidTemp <= Ttarget) return 0;
            const neededTotalEgg = (liquidMass * (liquidTemp - Ttarget)) / (Ttarget - eggTemp);
            const increase = neededTotalEgg - eggMass;
            return Math.max(0, increase);
        }
    
        /**
         * Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ù„ÙˆÙ„
         */
        window.applyMassSolution = function(newMass) {
            const liquidMassInput = document.getElementById('liquidMass');
            if (liquidMassInput) {
                liquidMassInput.value = newMass;
                calculateTempering();
                alert(`âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ ÙƒØªÙ„Ø© Ø§Ù„Ø®Ù„ÙŠØ· Ø¥Ù„Ù‰ ${newMass} Øº`);
            }
        };
    
        window.applyTempSolution = function(newTemp) {
            const liquidTempInput = document.getElementById('liquidTemp');
            if (liquidTempInput) {
                liquidTempInput.value = newTemp;
                calculateTempering();
                alert(`âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø®Ù„ÙŠØ· Ø¥Ù„Ù‰ ${newTemp}Â°C`);
            }
        };
    
        window.applyEggSolution = function(newEggMass) {
            const eggMassInput = document.getElementById('eggMass');
            if (eggMassInput) {
                eggMassInput.value = newEggMass;
                calculateTempering();
                alert(`âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ ÙƒØªÙ„Ø© Ø§Ù„Ø¨ÙŠØ¶ Ø¥Ù„Ù‰ ${newEggMass} Øº`);
            }
        };
    
        /**
         * ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØµÙˆØ± Ø§Ù„Ù…Ø±Ø¦ÙŠ Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø©
         */
        function updateTemperatureVisualization(batches) {
            const viz = document.getElementById('temperatureVisualization');
            if (!viz) return;
            
            const finalTemp = batches[batches.length - 1].tempAfter;
            const minTemp = 20;
            const maxTemp = 85;
            
            let indicatorsHTML = '';
            
            batches.forEach(batch => {
                const batchPercentage = Math.min(100, Math.max(0, ((batch.tempAfter - minTemp) / (maxTemp - minTemp)) * 100));
                const isDanger = batch.tempAfter > 68;
                const isWarning = batch.tempAfter > 65 && batch.tempAfter <= 68;
                const color = isDanger ? '#e53e3e' : isWarning ? '#d69e2e' : '#38a169';
                
                indicatorsHTML += `
                    <div style="
                        position: absolute; 
                        left: ${batchPercentage}%; 
                        top: -8px; 
                        width: 4px; 
                        height: 46px; 
                        background: ${color};
                        border-radius: 2px;
                        box-shadow: 0 0 3px rgba(0,0,0,0.3);
                    "></div>
                    <div style="
                        position: absolute;
                        left: ${batchPercentage}%;
                        top: 35px;
                        transform: translateX(-50%);
                        background: white;
                        padding: 2px 6px;
                        border-radius: 3px;
                        font-size: 11px;
                        font-weight: bold;
                        color: ${color};
                        border: 1px solid ${color};
                        white-space: nowrap;
                    ">${batch.tempAfter}Â°</div>
                `;
            });
            
            // Ø®Ø·ÙˆØ· Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø­Ø±Ø¬Ø©
            const dangerLine = ((68 - minTemp) / (maxTemp - minTemp)) * 100;
            const warningLine = ((65 - minTemp) / (maxTemp - minTemp)) * 100;
            
            indicatorsHTML += `
                <div style="position: absolute; left: ${dangerLine}%; top: -10px; width: 2px; height: 50px; background: #e53e3e; border-left: 2px dashed #e53e3e;"></div>
                <div style="position: absolute; left: ${warningLine}%; top: -10px; width: 2px; height: 50px; background: #d69e2e; border-left: 2px dashed #d69e2e;"></div>
            `;
            
            viz.innerHTML = indicatorsHTML;
        }
    
        /**
         * Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„ÙˆØµÙØ©
         */
        function autoFillFromRecipe() {
            if (!currentRecipe) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙØ© Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ');
                return;
            }
            
            const liquidMass = currentRecipe.butter + currentRecipe.sugar + currentRecipe.honey + currentRecipe.soda;
            
            const eggMassInput = document.getElementById('eggMass');
            const liquidMassInput = document.getElementById('liquidMass');
            const batchCountInput = document.getElementById('batchCount');
            
            if (eggMassInput) eggMassInput.value = currentRecipe.eggs.toFixed(1);
            if (liquidMassInput) liquidMassInput.value = liquidMass.toFixed(1);
            if (batchCountInput) batchCountInput.value = '5'; // 5 Ø¯ÙØ¹Ø§Øª Ù„Ù„Ø³Ù„Ø§Ù…Ø©
            
            alert('âœ… ØªÙ… Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„ÙˆØµÙØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©');
        }
    
        // ===== Ù…Ø­ÙˆÙ„ Ø§Ù„Ù…Ù†Ù‡Ø¬ÙŠØ§Øª Ø§Ù„Ù…ØµØ­Ø­ =====
        
        function initMethodConverter() {
            // Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¨ÙˆÙŠØ¨
        }
    
        function switchMethod(method) {
            const scientificBtn = document.getElementById('scientific-method-btn');
            const allInOneBtn = document.getElementById('all-in-one-method-btn');
            const scientificContent = document.getElementById('scientific-method-content');
            const allInOneContent = document.getElementById('all-in-one-method-content');
            
            if (!scientificBtn || !allInOneBtn || !scientificContent || !allInOneContent) return;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø©
            scientificBtn.classList.toggle('active', method === 'scientific');
            allInOneBtn.classList.toggle('active', method === 'all-in-one');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
            scientificContent.classList.toggle('active', method === 'scientific');
            allInOneContent.classList.toggle('active', method === 'all-in-one');
        }
    
        function convertToAllInOne() {
            if (!currentRecipe) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙØ© Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ');
                return;
            }
            
            const confirmConvert = confirm(
                'âš ï¸ ØªØ­Ø°ÙŠØ±: Ø·Ø±ÙŠÙ‚Ø© "Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©" Ù…Ø­ÙÙˆÙØ© Ø¨Ø§Ù„Ù…Ø®Ø§Ø·Ø±:\n\n' +
                'â€¢ Ø®Ø·Ø± ØªØ®Ø«Ø± Ø¨Ø±ÙˆØªÙŠÙ† Ø§Ù„Ø¨ÙŠØ¶ (70% Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©)\n' +
                'â€¢ Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø© ØªØ­ØªØ§Ø¬ Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„\n' + 
                'â€¢ Ù†ØªØ§Ø¦Ø¬ ØºÙŠØ± Ù…ØªØ³Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª\n\n' +
                'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ† ÙÙ‚Ø·ØŸ'
            );
            
            if (!confirmConvert) return;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù„Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
            const adjustedRecipe = {
                ...currentRecipe,
                eggs: currentRecipe.eggs * 0.9,  // ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¶ 10%
                flour: currentRecipe.flour * 1.05, // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ 5%
            };
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            const eggsInput = document.getElementById('eggs');
            const flourInput = document.getElementById('flour');
            
            if (eggsInput) eggsInput.value = adjustedRecipe.eggs.toFixed(1);
            if (flourInput) flourInput.value = adjustedRecipe.flour.toFixed(1);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ­Ù„ÙŠÙ„
            analyzeRecipe();
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const methodContent = document.getElementById('all-in-one-method-content');
            if (methodContent) {
                // Ø¥Ø²Ø§Ù„Ø© alert Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ù† ÙˆØ¬Ø¯
                const oldAlert = methodContent.querySelector('.conversion-result');
                if (oldAlert) oldAlert.remove();
                
                const resultAlert = document.createElement('div');
                resultAlert.className = 'alert alert-info conversion-result';
                resultAlert.style.marginTop = '15px';
                resultAlert.innerHTML = `
                    <strong>âœ… ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­:</strong>
                    <ul style="margin: 10px 0; padding-right: 20px;">
                        <li>Ø§Ù„Ø¨ÙŠØ¶: ${currentRecipe.eggs.toFixed(1)}Øº â†’ ${adjustedRecipe.eggs.toFixed(1)}Øº (-10%)</li>
                        <li>Ø§Ù„Ø¯Ù‚ÙŠÙ‚: ${currentRecipe.flour.toFixed(1)}Øº â†’ ${adjustedRecipe.flour.toFixed(1)}Øº (+5%)</li>
                        <li>ÙˆÙ‚Øª Ø§Ù„Ø±Ø§Ø­Ø©: 30-60 â†’ 15 Ø¯Ù‚ÙŠÙ‚Ø©</li>
                        <li>Ø®Ø·Ø± Ø§Ù„ØªØ®Ø«Ø±: Ù…Ù†Ø®ÙØ¶ â†’ Ù…ØªÙˆØ³Ø·</li>
                    </ul>
                    <p style="margin-top: 10px; color: #d69e2e;"><strong>ØªØ­Ø°ÙŠØ±:</strong> Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ù„Ù„Ø®Ø¨Ø±Ø§Ø¡ ÙÙ‚Ø·!</p>
                `;
                methodContent.appendChild(resultAlert);
            }
            
            alert('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø·Ø±ÙŠÙ‚Ø© "Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©"');
        }
    
        // ===== Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­Ø³Ù‘Ù† =====
        
        function initRatingSystem() {
            // Ø§Ù„Ù†Ø¬ÙˆÙ…
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    currentRating = rating;
                    
                    stars.forEach(s => {
                        const sRating = parseInt(s.getAttribute('data-rating'));
                        s.classList.toggle('active', sRating <= rating);
                    });
                });
            });
            
            // Ù†Ø¬Ø§Ø­/ÙØ´Ù„
            const successBtns = document.querySelectorAll('.success-btn, .failure-btn');
            successBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    successBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSuccess = this.classList.contains('success-btn');
                });
            });
            
            // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
            const saveFeedbackBtn = document.getElementById('saveFeedback');
            if (saveFeedbackBtn) {
                saveFeedbackBtn.addEventListener('click', saveRecipeFeedback);
            }
        }
    
        /**
         * Ø­ÙØ¸ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„ÙˆØµÙØ©
         */
        function saveRecipeFeedback() {
            if (savedRecipes.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØµÙØ© Ù…Ø­ÙÙˆØ¸Ø© Ø­Ø¯ÙŠØ«Ø§Ù‹ Ù„Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù„ÙŠÙ‡Ø§');
                return;
            }
            
            const commentArea = document.getElementById('recipeComment');
            if (!commentArea) return;
            
            const comment = commentArea.value.trim();
            
            if (currentRating === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªÙ‚ÙŠÙŠÙ… Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ…');
                return;
            }
            
            if (currentSuccess === null) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØµÙ†ÙŠÙ Ø§Ù„ÙˆØµÙØ© (Ù†Ø¬Ø­Øª/ÙØ´Ù„Øª)');
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± ÙˆØµÙØ© Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
            const lastRecipe = savedRecipes[savedRecipes.length - 1];
            lastRecipe.rating = currentRating;
            lastRecipe.success = currentSuccess;
            lastRecipe.comment = comment;
            lastRecipe.scientificScore = currentAnalysis?.qualityScore || 0;
            lastRecipe.feedbackDate = new Date().toISOString();
            
            saveRecipesToStorage();
            updateLibraryTab();
            
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­!');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„
            commentArea.value = '';
            currentRating = 0;
            currentSuccess = null;
            
            document.querySelectorAll('.star').forEach(star => star.classList.remove('active'));
            document.querySelectorAll('.success-btn, .failure-btn').forEach(btn => btn.classList.remove('active'));
        }
    
        // ===== Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ =====
        
        /**
         * ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙØ© - Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
         */
        function analyzeRecipe() {
            const recipe = getRecipeFromInputs();
            if (!recipe) return;
            
            currentRecipe = recipe;
            currentAnalysis = performScientificAnalysis(recipe);
            
            displayAnalysisResults();
            updateAllTabs();
        }
    
        /**
         * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙØ© Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª - Ù…Ø­Ø³Ù‘Ù†
         */
        function getRecipeFromInputs() {
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (!flourInput || !butterInput || !sugarInput || !honeyInput || !eggsInput || !sodaInput) {
                console.error('Ø¨Ø¹Ø¶ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                return null;
            }
            
            const flour = parseFloat(flourInput.value) || 0;
            const butter = parseFloat(butterInput.value) || 0;
            const sugar = parseFloat(sugarInput.value) || 0;
            const honey = parseFloat(honeyInput.value) || 0;
            const eggs = parseFloat(eggsInput.value) || 0;
            const soda = parseFloat(sodaInput.value) || 0;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (flour < 0 || butter < 0 || sugar < 0 || honey < 0 || eggs < 0 || soda < 0) {
                alert('âŒ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø³Ø§Ù„Ø¨Ø© ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­Ø©!');
                return null;
            }
            
            if (flour > 5000 || butter > 2000 || sugar > 2000 || honey > 2000 || eggs > 1000 || soda > 100) {
                alert('âš ï¸ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù‚ÙŠÙ… ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹! ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ÙˆØ­Ø¯Ø§Øª (Ø¬Ø±Ø§Ù…)');
                return null;
            }
            
            const total = flour + butter + sugar + honey + eggs + soda;
            
            if (total <= 0) {
                alert('âŒ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±!');
                return null;
            }
            
            return {
                flour,
                butter,
                sugar,
                honey,
                eggs,
                soda,
                total,
                flourPct: (flour / total) * 100,
                butterPct: (butter / total) * 100,
                sugarPct: (sugar / total) * 100,
                honeyPct: (honey / total) * 100,
                eggsPct: (eggs / total) * 100,
                sodaPct: (soda / total) * 100,
                sugarsPct: ((sugar + honey) / total) * 100
            };
        }
    
        /**
         * ØªØ­Ù„ÙŠÙ„ Ø¹Ù„Ù…ÙŠ Ù„Ù„ÙˆØµÙØ©
         */
        function performScientificAnalysis(recipe) {
            const analysis = {};
            let qualityScore = 100;
            
            analysis.flour = checkRange(recipe.flourPct, SCIENTIFIC_RANGES.flour);
            analysis.butter = checkRange(recipe.butterPct, SCIENTIFIC_RANGES.butter);
            analysis.sugars = checkRange(recipe.sugarsPct, SCIENTIFIC_RANGES.sugars);
            analysis.eggs = checkRange(recipe.eggsPct, SCIENTIFIC_RANGES.eggs);
            analysis.soda = checkRange(recipe.sodaPct, SCIENTIFIC_RANGES.soda);
            
            // Ø®ØµÙ… Ù†Ù‚Ø§Ø· Ù„ÙƒÙ„ Ù…ÙƒÙˆÙ† Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚
            Object.values(analysis).forEach(item => {
                if (item.status === 'low' || item.status === 'high') {
                    qualityScore -= 20;
                }
            });
            
            analysis.qualityScore = Math.max(0, qualityScore);
            
            return analysis;
        }
    
        /**
         * ÙØ­Øµ Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…ÙƒÙˆÙ†
         */
        function checkRange(value, range) {
            if (value < range.min) {
                return { 
                    status: 'low', 
                    message: `Ù…Ù†Ø®ÙØ¶ (${range.min}-${range.max}% Ù…Ø«Ø§Ù„ÙŠ)`,
                    deviation: range.min - value
                };
            } else if (value > range.max) {
                return { 
                    status: 'high', 
                    message: `Ù…Ø±ØªÙØ¹ (${range.min}-${range.max}% Ù…Ø«Ø§Ù„ÙŠ)`,
                    deviation: value - range.max
                };
            } else {
                return { 
                    status: 'optimal', 
                    message: `Ù…Ø«Ø§Ù„ÙŠ (${range.min}-${range.max}%)`,
                    deviation: 0
                };
            }
        }
    
        /**
         * Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ - Ù…Ø­Ø³Ù‘Ù†
         */
        function displayAnalysisResults() {
            if (!currentRecipe || !currentAnalysis) return;
            
            const resultDiv = document.getElementById('analysis-result');
            if (!resultDiv) return;
            
            const score = currentAnalysis.qualityScore;
            const scoreClass = score >= 80 ? 'score-high' : score >= 60 ? 'score-medium' : 'score-low';
            
            let html = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="quality-score ${scoreClass}" style="display: inline-block; font-size: 24px; padding: 15px 30px;">
                        ${score}/100 â­
                    </div>
                    <div class="progress-bar" style="margin-top: 15px;">
                        <div class="progress-fill ${scoreClass.replace('score-', 'progress-')}" style="width: ${score}%"></div>
                    </div>
                </div>
                
                <table>
                    <tr>
                        <th>Ø§Ù„Ù…ÙƒÙˆÙ†</th>
                        <th>Ø§Ù„Ø¬Ø±Ø§Ù…Ø§Øª</th>
                        <th>Ø§Ù„Ù†Ø³Ø¨Ø© %</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    </tr>
            `;
            
            html += addTableRow('Ø¯Ù‚ÙŠÙ‚', currentRecipe.flour, currentRecipe.flourPct, currentAnalysis.flour);
            html += addTableRow('Ø²Ø¨Ø¯Ø©', currentRecipe.butter, currentRecipe.butterPct, currentAnalysis.butter);
            html += addTableRow('Ø³ÙƒØ±', currentRecipe.sugar, currentRecipe.sugarPct, {status: 'info', message: 'Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª'});
            html += addTableRow('Ø¹Ø³Ù„', currentRecipe.honey, currentRecipe.honeyPct, {status: 'info', message: 'Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª'});
            html += addTableRow('Ø³ÙƒØ±ÙŠØ§Øª ÙƒÙ„ÙŠ', currentRecipe.sugar + currentRecipe.honey, currentRecipe.sugarsPct, currentAnalysis.sugars);
            html += addTableRow('Ø¨ÙŠØ¶', currentRecipe.eggs, currentRecipe.eggsPct, currentAnalysis.eggs);
            html += addTableRow('ØµÙˆØ¯Ø§', currentRecipe.soda, currentRecipe.sodaPct, currentAnalysis.soda);
            
            html += `</table>`;
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ù…Ø´Ø§ÙƒÙ„
            const predictions = predictProblems(currentRecipe, currentAnalysis);
            if (predictions.warnings.length > 0) {
                html += `<div class="prediction-warning" style="margin-top: 20px;">`;
                html += `<h4>âš ï¸ ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© (${predictions.overallRisk}% Ø®Ø·ÙˆØ±Ø©)</h4>`;
                predictions.warnings.forEach(warning => {
                    const alertClass = warning.severity === 'high' ? 'alert-danger' : 
                                     warning.severity === 'medium' ? 'alert-warning' : 'alert-info';
                    html += `
                        <div class="alert ${alertClass}" style="margin: 10px 0;">
                            <strong>${warning.problem}</strong> (${warning.probability}% Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©)<br>
                            <span style="font-size: 0.9em;">Ø§Ù„Ø³Ø¨Ø¨: ${warning.reason}</span><br>
                            <span style="color: #38a169;"><strong>Ø§Ù„Ø­Ù„:</strong> ${warning.solution}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            
            // Ø±Ø³Ø§Ù„Ø© Ø®ØªØ§Ù…ÙŠØ©
            html += `<div class="alert ${score >= 80 ? 'alert-success' : score >= 60 ? 'alert-warning' : 'alert-danger'}" style="margin-top: 20px;">`;
            if (score >= 80) {
                html += `<strong>âœ… ÙˆØµÙØªÙƒ Ù…Ù…ØªØ§Ø²Ø© Ø¹Ù„Ù…ÙŠØ§Ù‹!</strong> Ø§Ù„Ù†Ø³Ø¨ Ø¶Ù…Ù† Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø«Ù„Ù‰.`;
            } else if (score >= 60) {
                html += `<strong>âš ï¸ ÙˆØµÙØªÙƒ Ø¬ÙŠØ¯Ø© ÙˆÙ„ÙƒÙ† ÙŠÙ…ÙƒÙ† ØªØ­Ø³ÙŠÙ†Ù‡Ø§:</strong> Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ø³Ø¨ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ.`;
            } else {
                html += `<strong>âŒ ÙˆØµÙØªÙƒ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†Ø§Øª:</strong> Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù†Ø³Ø¨ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù„Ù…ÙŠ.`;
            }
            html += `</div>`;
            
            resultDiv.innerHTML = html;
        }
    
        /**
         * Ø¥Ø¶Ø§ÙØ© ØµÙ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
         */
        function addTableRow(ingredient, grams, percent, analysis) {
            const statusClass = analysis.status === 'optimal' ? 'score-high' : 
                              analysis.status === 'low' ? 'score-medium' :
                              analysis.status === 'high' ? 'score-low' : '';
            const statusText = analysis.status === 'optimal' ? 'âœ…' : 
                             analysis.status === 'low' ? 'âš ï¸' :
                             analysis.status === 'high' ? 'âŒ' : 'â„¹ï¸';
            
            return `
                <tr>
                    <td><strong>${ingredient}</strong></td>
                    <td>${grams.toFixed(1)}Øº</td>
                    <td>${percent.toFixed(1)}%</td>
                    <td><span class="${statusClass}">${statusText} ${analysis.message}</span></td>
                </tr>
            `;
        }
    
        /**
         * Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ - Ù…Ù†Ø·Ù‚ Ù…Ø­Ø³Ù‘Ù†
         */
        function predictProblems(recipe, analysis) {
            const warnings = [];
            let overallRisk = 0;
            
            // 1. ÙØ­Øµ Ø¹Ø¯Ù… Ø§Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ
            if (recipe.sodaPct > 0.7 && recipe.honeyPct < 8) {
                warnings.push({
                    severity: 'high',
                    problem: 'Ø·Ø¹Ù… Ù‚Ù„ÙˆÙŠ (ØµØ§Ø¨ÙˆÙ†ÙŠ)',
                    reason: 'Ø§Ù„ØµÙˆØ¯Ø§ Ø¹Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¹Ø³Ù„ Ù…Ù†Ø®ÙØ¶',
                    probability: 85,
                    solution: 'Ø²Ø¯ Ø§Ù„Ø¹Ø³Ù„ Ø¨Ù€ 30% Ø£Ùˆ Ù‚Ù„Ù„ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù€ 25%'
                });
                overallRisk += 25;
            }
            
            // 2. ÙØ­Øµ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù‚ÙˆØ§Ù…
            if (recipe.flourPct < 48 && recipe.sugarsPct > 32) {
                warnings.push({
                    severity: 'medium',
                    problem: 'Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø© Ø¬Ø¯Ø§Ù‹',
                    reason: 'Ø³ÙˆØ§Ø¦Ù„ Ø¹Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¯Ù‚ÙŠÙ‚ Ù…Ù†Ø®ÙØ¶',
                    probability: 70,
                    solution: 'Ø²Ø¯ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ù€ 50-80 ØºØ±Ø§Ù…'
                });
                overallRisk += 15;
            }
            
            // 3. ÙØ­Øµ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù„ÙˆÙ†
            if (recipe.sodaPct < 0.4) {
                warnings.push({
                    severity: 'low',
                    problem: 'Ù„ÙˆÙ† Ø¨Ø§Ù‡Øª',
                    reason: 'Ø§Ù„ØµÙˆØ¯Ø§ Ù‚Ù„ÙŠÙ„Ø© Ù„ØªÙØ¹ÙŠÙ„ ØªÙØ§Ø¹Ù„ Maillard',
                    probability: 60,
                    solution: 'Ø²Ø¯ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù€ 1-2 ØºØ±Ø§Ù…'
                });
                overallRisk += 10;
            }
            
            // 4. ÙØ­Øµ Ø§Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„Ø¹Ø§Ù…
            if (analysis.qualityScore < 60) {
                warnings.push({
                    severity: 'medium',
                    problem: 'ÙˆØµÙØ© ØºÙŠØ± Ù…ØªÙˆØ§Ø²Ù†Ø©',
                    reason: 'Ø¬ÙˆØ¯Ø© Ø§Ù„ÙˆØµÙØ© Ù…Ù†Ø®ÙØ¶Ø© Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ',
                    probability: 75,
                    solution: 'Ø±Ø§Ø¬Ø¹ Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠ'
                });
                overallRisk += 20;
            }
            
            return {
                warnings: warnings,
                overallRisk: Math.min(overallRisk, 100),
                riskLevel: overallRisk > 50 ? 'high' : overallRisk > 25 ? 'medium' : 'low'
            };
        }
    
        // ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª =====
        
        function updateAllTabs() {
            updateConverterTab();
            updateScientificTab();
            updateCalculatorTab();
            updateAdvisorTab();
            updateLibraryTab();
        }
    
        /**
         * ØªØ­Ø¯ÙŠØ« ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­ÙˆÙ„
         */
        function updateConverterTab() {
            const content = document.getElementById('converter-content');
            if (!content || !currentRecipe) return;
            
            content.innerHTML = `
                <div class="alert alert-info">
                    <strong>ğŸ”„ Ù…Ø­ÙˆÙ„ Ø§Ù„Ù…Ù†Ù‡Ø¬ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…:</strong> 
                    ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ø¢Ù…Ù†Ø© ÙˆØ·Ø±ÙŠÙ‚Ø© "Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©" Ø§Ù„Ø³Ø±ÙŠØ¹Ø©.
                </div>
                
                <div class="scaling-mode-toggle" style="margin: 20px 0;">
                    <button class="btn-mode active" id="scientific-method-btn">ğŸ”¬ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</button>
                    <button class="btn-mode" id="all-in-one-method-btn">âš¡ Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</button>
                </div>
                
                <div id="scientific-method-content" class="method-content active">
                    <h3>ğŸ”¬ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© (Ù…Ø³ØªØ­Ø³Ù† Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†)</h3>
                    <div class="alert alert-success">
                        <strong>Ù…Ø²Ø§ÙŠØ§:</strong> ØªØ¬Ù†Ø¨ ØªØ®Ø«Ø± Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ† - Ù†ØªØ§Ø¦Ø¬ Ù…ØªØ³Ù‚Ø© - Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©
                    </div>
                    
                    <div class="method-steps">
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ§Øª:</h4>
                        <ol style="padding-right: 20px;">
                            <li>ØªØ³Ø®ÙŠÙ† Ø§Ù„Ø²Ø¨Ø¯Ø© + Ø§Ù„Ø³ÙƒØ± + Ø§Ù„Ø¹Ø³Ù„ Ø¥Ù„Ù‰ 115-120Â°C</li>
                            <li>Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ¯Ø§ ÙˆØ§Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø³Ø±ÙŠØ¹ (Ø³ÙŠØ­Ø¯Ø« ÙÙˆØ±Ø§Ù†)</li>
                            <li>Ø§Ù„ØªØ¨Ø±ÙŠØ¯ Ø¥Ù„Ù‰ 85-90Â°C Ø«Ù… Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¢Ù…Ù†</li>
                            <li>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ¶ Ø¹Ù„Ù‰ 3-5 Ø¯ÙØ¹Ø§Øª Ù…Ø¹ Ø§Ù„Ø®ÙÙ‚ Ø§Ù„Ù…Ø³ØªÙ…Ø±</li>
                            <li>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ ÙˆØ§Ù„Ø¹Ø¬Ù† Ø§Ù„Ø®ÙÙŠÙ</li>
                            <li>Ø§Ù„Ø±Ø§Ø­Ø© ÙÙŠ Ø§Ù„Ø«Ù„Ø§Ø¬Ø© 30-60 Ø¯Ù‚ÙŠÙ‚Ø©</li>
                        </ol>
                    </div>
                </div>
                
                <div id="all-in-one-method-content" class="method-content">
                    <h3>âš¡ Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø© (Ù„Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ† ÙÙ‚Ø·)</h3>
                    <div class="alert alert-warning">
                        <strong>ØªØ­Ø°ÙŠØ±:</strong> Ø®Ø·Ø± ØªØ®Ø«Ø± Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ† - ÙŠØ­ØªØ§Ø¬ Ø®Ø¨Ø±Ø© - Ù†ØªØ§Ø¦Ø¬ ØºÙŠØ± Ù…Ø¶Ù…ÙˆÙ†Ø©
                    </div>
                    
                    <div class="method-steps">
                        <h4>Ø§Ù„Ø®Ø·ÙˆØ§Øª:</h4>
                        <ol style="padding-right: 20px;">
                            <li>Ø®Ù„Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ ÙˆØ¹Ø§Ø¡</li>
                            <li>Ø§Ù„Ø¹Ø¬Ù† Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯ÙˆÙ† ØªØ¨Ø±ÙŠØ¯</li>
                            <li>Ø§Ù„Ø±Ø§Ø­Ø© 15 Ø¯Ù‚ÙŠÙ‚Ø© ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©</li>
                        </ol>
                    </div>
                    
                    <div class="conversion-notes">
                        <h4>Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„:</h4>
                        <ul style="padding-right: 20px;">
                            <li>ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¶ 10% Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ®Ø«Ø±</li>
                            <li>ØªÙ‚Ù„ÙŠÙ„ ÙˆÙ‚Øª Ø§Ù„Ø®Ø¨Ø² 1-2 Ø¯Ù‚ÙŠÙ‚Ø©</li>
                            <li>Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ 5% Ù„Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø©</li>
                        </ul>
                    </div>
                    
                    <button class="btn btn-warning" id="convert-to-all-in-one" style="margin-top: 15px;">
                        âš¡ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ "Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©"
                    </button>
                </div>
            `;
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            const scientificBtn = document.getElementById('scientific-method-btn');
            const allInOneBtn = document.getElementById('all-in-one-method-btn');
            const convertBtn = document.getElementById('convert-to-all-in-one');
            
            if (scientificBtn) {
                scientificBtn.addEventListener('click', () => switchMethod('scientific'));
            }
            
            if (allInOneBtn) {
                allInOneBtn.addEventListener('click', () => switchMethod('all-in-one'));
            }
            
            if (convertBtn) {
                convertBtn.addEventListener('click', convertToAllInOne);
            }
        }
    
        /**
         * ØªØ­Ø¯ÙŠØ« ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©
         */
        function updateScientificTab() {
            const content = document.getElementById('scientific-content');
            if (!content || !currentRecipe) return;
            
            content.innerHTML = `
                <div class="alert alert-success">
                    <strong>ğŸ”¬ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ù…Ø«Ù„Ù‰:</strong> 
                    ØªØ³Ù„Ø³Ù„ Ø¯Ù‚ÙŠÙ‚ ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙˆØ§Øµ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ© ÙˆØ§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© Ù„Ù„Ù…ÙƒÙˆÙ†Ø§Øª.
                </div>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-time">Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ø­Ù„Ùˆ</div>
                        <div class="timeline-temp">ğŸŒ¡ï¸ 115-120Â°C</div>
                        <p>ØªØ³Ø®ÙŠÙ† ${currentRecipe.butter.toFixed(1)}Øº Ø²Ø¨Ø¯Ø© + ${currentRecipe.sugar.toFixed(1)}Øº Ø³ÙƒØ± + ${currentRecipe.honey.toFixed(1)}Øº Ø¹Ø³Ù„</p>
                        <p class="scientific-note">ğŸ”¬ <em>Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø±Ø§Ø±Ø© ØªØ¶Ù…Ù† Ø°ÙˆØ¨Ø§Ù† Ø§Ù„ÙƒØ±ÙŠØ³ØªØ§Ù„Ø§Øª ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØ¯Ø§</em></p>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-time">Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªÙØ§Ø¹Ù„ Ø§Ù„ØµÙˆØ¯Ø§ Ø§Ù„Ø­Ø§Ø³Ù…</div>
                        <div class="timeline-temp">ğŸŒ¡ï¸ 115-120Â°C</div>
                        <p>Ø¥Ø¶Ø§ÙØ© ${currentRecipe.soda.toFixed(1)}Øº ØµÙˆØ¯Ø§ Ù…Ø¹ Ø§Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø³Ø±ÙŠØ¹ - Ø³ÙŠØ­Ø¯Ø« ÙÙˆØ±Ø§Ù†</p>
                        <p class="scientific-note">ğŸ”¬ <em>Ø§Ù„ØªÙØ§Ø¹Ù„: NaHCOâ‚ƒ + Hâº â†’ Naâº + COâ‚‚ + Hâ‚‚O</em></p>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-time">Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„ØªØ¨Ø±ÙŠØ¯ Ù„Ù„ØªÙ…Ø¨ÙŠØ± Ø§Ù„Ø¢Ù…Ù†</div>
                        <div class="timeline-temp success">ğŸŒ¡ï¸ 85-90Â°C</div>
                        <p>ØªØ¨Ø±ÙŠØ¯ Ø§Ù„Ø®Ù„ÙŠØ· Ø¥Ù„Ù‰ 85-90Â°C Ø§Ø³ØªØ¹Ø¯Ø§Ø¯Ø§Ù‹ Ù„Ù„ØªÙ…Ø¨ÙŠØ±</p>
                        <p class="scientific-note">ğŸ”¬ <em>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø«Ù„Ù‰ Ù„Ù„ØªÙ…Ø¨ÙŠØ± Ø§Ù„Ø¢Ù…Ù† Ù„Ù„Ø¨Ø±ÙˆØªÙŠÙ†</em></p>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-time">Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„ØªÙ…Ø¨Ø±Ù†Ø¬ Ø§Ù„Ø¹Ù„Ù…ÙŠ (3-5 Ø¯ÙØ¹Ø§Øª)</div>
                        <div class="timeline-temp success">ğŸŒ¡ï¸ 65-68Â°C Ù†Ù‡Ø§Ø¦ÙŠ</div>
                        <p>Ø¥Ø¶Ø§ÙØ© ${currentRecipe.eggs.toFixed(1)}Øº Ø¨ÙŠØ¶ Ø¹Ù„Ù‰ Ø¯ÙØ¹Ø§Øª Ù…Ø¹ Ø§Ù„Ø®ÙÙ‚ Ø§Ù„Ù…Ø³ØªÙ…Ø±</p>
                        <p class="scientific-note">ğŸ”¬ <em>Ø§Ù„Ø¯ÙØ¹Ø§Øª ØªÙ…Ù†Ø¹ ØµØ¯Ù…Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ù„Ù„Ø¨Ø±ÙˆØªÙŠÙ† ÙˆØªØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ­Ù„Ø§Ø¨</em></p>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-time">Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø¯Ù…Ø¬ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø¯Ø±ÙˆØ³</div>
                        <div class="timeline-temp">ğŸŒ¡ï¸ 50-55Â°C</div>
                        <p>Ø¥Ø¶Ø§ÙØ© ${currentRecipe.flour.toFixed(1)}Øº Ø¯Ù‚ÙŠÙ‚ Ø¹Ù„Ù‰ Ø¯ÙØ¹Ø§Øª ÙˆØ§Ù„Ø¹Ø¬Ù† Ø§Ù„Ø®ÙÙŠÙ</p>
                        <p class="scientific-note">ğŸ”¬ <em>ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹Ø¬Ù† Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„Ù…Ù†Ø¹ ØªÙƒÙˆÙŠÙ† Ø¬Ù„ÙˆØªÙŠÙ† Ù‚ÙˆÙŠ</em></p>
                    </div>
                </div>
                
                <div class="scientific-explanation">
                    <h3>ğŸ§ª Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 20px 0;">
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-right: 4px solid #3182ce;">
                            <h4>ğŸŒ¡ï¸ ØªØ­ÙƒÙ… ÙÙŠ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h4>
                            <p>Ø§Ù„ØªÙ…Ø¨ÙŠØ± ÙŠÙ…Ù†Ø¹ ØªØ®Ø«Ø± Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ† Ø¹Ù†Ø¯ 70Â°CØŒ Ù…Ù…Ø§ ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ù… Ø§Ù„Ù†Ø§Ø¹Ù… ÙˆØ§Ù„Ø§Ø³ØªØ­Ù„Ø§Ø¨ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ.</p>
                        </div>
                        <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-right: 4px solid #38a169;">
                            <h4>âš—ï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØ¯Ø§ Ø§Ù„ÙƒØ§Ù…Ù„</h4>
                            <p>Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ© (115-120Â°C) ØªØ¶Ù…Ù† ØªÙØ¹ÙŠÙ„ ÙƒØ§Ù…Ù„ Ù„Ù„ØµÙˆØ¯Ø§ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©.</p>
                        </div>
                        <div style="background: #fffaf0; padding: 15px; border-radius: 8px; border-right: 4px solid #d69e2e;">
                            <h4>ğŸ•’ ÙˆÙ‚Øª Ø§Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠ</h4>
                            <p>30-60 Ø¯Ù‚ÙŠÙ‚Ø© Ø±Ø§Ø­Ø© ØªØ³Ù…Ø­ Ø¨ØªÙƒÙˆÙ† Ø´Ø¨ÙƒØ© Ø¬Ù„ÙˆØªÙŠÙ† Ù…ØªÙˆØ§Ø²Ù†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø¯Ù‡ÙˆÙ† Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙØ±Ø¯.</p>
                        </div>
                    </div>
                </div>
                
                <div class="risk-comparison">
                    <h3>ğŸ“ˆ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±: Ø§Ù„Ø¹Ù„Ù…ÙŠØ© vs Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</h3>
                    <table>
                        <tr>
                            <th>Ø§Ù„Ù…Ø®Ø§Ø·Ø±</th>
                            <th>ğŸ”¬ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</th>
                            <th>âš¡ Ø§Ù„ÙƒÙ„ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</th>
                        </tr>
                        <tr>
                            <td>ØªØ®Ø«Ø± Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†</td>
                            <td style="color: #38a169;">âœ… 0%</td>
                            <td style="color: #e53e3e;">âŒ 70%</td>
                        </tr>
                        <tr>
                            <td>Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø©</td>
                            <td style="color: #38a169;">âœ… 5%</td>
                            <td style="color: #e53e3e;">âŒ 60%</td>
                        </tr>
                        <tr>
                            <td>Ù†ØªØ§Ø¦Ø¬ ØºÙŠØ± Ù…ØªØ³Ù‚Ø©</td>
                            <td style="color: #38a169;">âœ… 10%</td>
                            <td style="color: #e53e3e;">âŒ 80%</td>
                        </tr>
                        <tr>
                            <td>Ù„ÙˆÙ† Ø¨Ø§Ù‡Øª</td>
                            <td style="color: #38a169;">âœ… 0%</td>
                            <td style="color: #e53e3e;">âŒ 40%</td>
                        </tr>
                    </table>
                </div>
            `;
        }
    
        /**
         * ØªØ­Ø¯ÙŠØ« ØªØ¨ÙˆÙŠØ¨ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
         */
        function updateCalculatorTab() {
            const content = document.getElementById('calculator-content');
            if (!content || !currentRecipe) return;
            
            const panSizes = [
                { size: 20, name: "20 Ø³Ù…", recommendedWeight: 100 },
                { size: 22, name: "22 Ø³Ù…", recommendedWeight: 120 },
                { size: 24, name: "24 Ø³Ù…", recommendedWeight: 150 },
                { size: 26, name: "26 Ø³Ù…", recommendedWeight: 170 },
                { size: 28, name: "28 Ø³Ù…", recommendedWeight: 200 }
            ];
            
            let layersHtml = '';
            panSizes.forEach(pan => {
                const numLayers = Math.floor(currentRecipe.total / pan.recommendedWeight);
                const usedWeight = (numLayers * pan.recommendedWeight).toFixed(1);
                const leftover = (currentRecipe.total - numLayers * pan.recommendedWeight).toFixed(1);
                
                layersHtml += `
                    <tr>
                        <td>${pan.name}</td>
                        <td>${pan.size} Ø³Ù…</td>
                        <td>${pan.recommendedWeight} Øº</td>
                        <td><strong>${numLayers}</strong> Ø·Ø¨Ù‚Ø©</td>
                        <td>${usedWeight} Øº</td>
                        <td style="color: ${leftover > 50 ? '#d69e2e' : '#38a169'};">${leftover} Øº</td>
                    </tr>
                `;
            });
            
            content.innerHTML = `
                <div class="alert alert-info">
                    <strong>ğŸ“ Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù‚Ø¹ÙŠØ©:</strong> 
                    ØªØ³ØªØ®Ø¯Ù… ÙƒØ«Ø§ÙØ© ${DOUGH_DENSITY} Ø¬Ù…/Ø³Ù…Â³ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©.
                </div>
                
                <h4>Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø¹Ø¬ÙŠÙ†Ø©: <strong>${currentRecipe.total.toFixed(1)} ØºØ±Ø§Ù…</strong></h4>
                
                <table style="margin-top: 15px;">
                    <tr>
                        <th>Ø§Ù„Ø­Ø¬Ù…</th>
                        <th>Ø§Ù„Ù‚Ø·Ø±</th>
                        <th>Ø§Ù„ÙˆØ²Ù†/Ø·Ø¨Ù‚Ø©</th>
                        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª</th>
                        <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                        <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                    </tr>
                    ${layersHtml}
                </table>
                
                <div class="alert alert-success" style="margin-top: 15px;">
                    <strong>ğŸ’¡ Ù†ØµÙŠØ­Ø©:</strong> Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ù„ÙØªØ§Øª Ø£Ùˆ Ø·Ø¨Ù‚Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ø±Ù‚ÙŠÙ‚Ø©.
                </div>
            `;
        }
    
        /**
         * ØªØ­Ø¯ÙŠØ« ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠ
         */
        function updateAdvisorTab() {
            const content = document.getElementById('advisor-content');
            if (!content || !currentRecipe || !currentAnalysis) return;
            
            let adviceHtml = '';
            
            // ØªØ­Ù„ÙŠÙ„ ÙƒÙ„ Ù…ÙƒÙˆÙ† Ø¨Ø´ÙƒÙ„ Ù…ÙØµÙ„
            adviceHtml += getFlourAdvice(currentRecipe, currentAnalysis);
            adviceHtml += getButterAdvice(currentRecipe, currentAnalysis);
            adviceHtml += getSugarsAdvice(currentRecipe, currentAnalysis);
            adviceHtml += getEggsAdvice(currentRecipe, currentAnalysis);
            adviceHtml += getSodaAdvice(currentRecipe, currentAnalysis);
            
            if (!adviceHtml) {
                adviceHtml = `
                    <div class="alert alert-success">
                        <h4>âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø«Ø§Ù„ÙŠØ© Ø¹Ù„Ù…ÙŠØ§Ù‹!</h4>
                        <p>ÙˆØµÙØªÙƒ Ù…ØªÙˆØ§Ø²Ù†Ø© ØªÙ…Ø§Ù…Ø§Ù‹ ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¹Ù„Ù…ÙŠØ©. Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù†:</p>
                        <ul style="padding-right: 20px;">
                            <li>Ù‚ÙˆØ§Ù… Ù…Ø«Ø§Ù„ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ù‡Ø´Ø§Ø´Ø© ÙˆØ§Ù„ØªÙ…Ø§Ø³Ùƒ</li>
                            <li>Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ø¬Ù…ÙŠÙ„ Ù…Ù† ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø§ÙŠØ§Ø±Ø¯</li>
                            <li>Ø±Ø·ÙˆØ¨Ø© Ù…Ø«Ø§Ù„ÙŠØ© ÙˆØ§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø·Ø¹Ù…</li>
                            <li>Ø³Ù‡ÙˆÙ„Ø© ÙÙŠ Ø§Ù„ÙØ±Ø¯ ÙˆØ§Ù„ØªØ´ÙƒÙŠÙ„</li>
                        </ul>
                    </div>
                `;
            }
            
            content.innerHTML = `
                <div class="alert alert-info">
                    <strong>ğŸ“ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¢Ø«Ø§Ø± Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ:</strong> 
                    Ø´Ø±Ø­ ØªØ£Ø«ÙŠØ± ÙƒÙ„ Ù…ÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙˆØ§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù„Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø­Ø§Ø« Ø§Ù„Ø¹Ù„Ù…ÙŠØ©.
                </div>
                ${adviceHtml}
            `;
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø¯Ù‚ÙŠÙ‚
         */
        function getFlourAdvice(recipe, analysis) {
            if (analysis.flour.status === 'optimal') return '';
            
            const diff = recipe.flourPct - SCIENTIFIC_RANGES.flour.ideal;
            const adjustGrams = (Math.abs(diff) / 100) * recipe.total;
            
            return `
                <div class="advisor-detail">
                    <h4>ğŸ¥– Ø§Ù„Ø¯Ù‚ÙŠÙ‚ (${recipe.flourPct.toFixed(1)}%)</h4>
                    <div class="alert ${analysis.flour.status === 'low' ? 'alert-warning' : 'alert-danger'}">
                        <strong>${analysis.flour.status === 'low' ? 'âš ï¸ Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨Ù†Ø§Ø¦ÙŠ' : 'âŒ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø¨Ø©'}</strong>
                    </div>
                    
                    <div class="advisor-effects">
                        <strong>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong>
                        <ul style="padding-right: 20px;">
                            ${analysis.flour.status === 'low' ? `
                                <li>Ø¶Ø¹Ù ÙÙŠ Ø´Ø¨ÙƒØ© Ø§Ù„Ø¬Ù„ÙˆØªÙŠÙ† ÙŠØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø©</li>
                                <li>ØµØ¹ÙˆØ¨Ø© ÙÙŠ ÙØ±Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªØ³Ø§Ùˆ</li>
                                <li>Ù‚Ø§Ø¨Ù„ÙŠØ© Ù„Ù„ÙƒØ³Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø®Ø¨Ø²</li>
                                <li>ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨ÙÙ‚Ø§Ø¹Ø§Øª COâ‚‚</li>
                            ` : `
                                <li>Ø´Ø¨ÙƒØ© Ø¬Ù„ÙˆØªÙŠÙ† Ù…ÙØ±Ø·Ø© Ø§Ù„Ù‚ÙˆØ© ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø¹Ø¬ÙŠÙ†Ø© Ù…Ø·Ø§Ø·ÙŠØ©</li>
                                <li>ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ÙØ±Ø¯ Ø¥Ù„Ù‰ Ø³Ù…Ø§ÙƒØ© 2mm Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</li>
                                <li>Ù†ØªÙŠØ¬Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ù‚Ø§Ø³ÙŠØ© ÙˆØ¬Ø§ÙØ©</li>
                                <li>Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„ØªÙ„ÙŠÙŠÙ† Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ø¶Ø¬</li>
                            `}
                        </ul>
                    </div>
                    
                    <div class="advisor-solution">
                        <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                        ${analysis.flour.status === 'low' ? 
                            `Ø£Ø¶Ù ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ø¯Ù‚ÙŠÙ‚ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© ${SCIENTIFIC_RANGES.flour.ideal}%` :
                            `Ù‚Ù„Ù„ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ø£Ùˆ Ø²Ø¯ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù„Ø© Ø¨Ù†Ø³Ø¨Ø© ${Math.abs(diff).toFixed(1)}%`
                        }
                    </div>
                </div>
            `;
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø²Ø¨Ø¯Ø©
         */
        function getButterAdvice(recipe, analysis) {
            if (analysis.butter.status === 'optimal') return '';
            
            const diff = recipe.butterPct - SCIENTIFIC_RANGES.butter.ideal;
            const adjustGrams = (Math.abs(diff) / 100) * recipe.total;
            
            return `
                <div class="advisor-detail">
                    <h4>ğŸ§ˆ Ø§Ù„Ø²Ø¨Ø¯Ø© (${recipe.butterPct.toFixed(1)}%)</h4>
                    <div class="alert ${analysis.butter.status === 'low' ? 'alert-warning' : 'alert-danger'}">
                        <strong>${analysis.butter.status === 'low' ? 'âš ï¸ Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø·Ø±Ø§ÙˆØ©' : 'âŒ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„Ø¯Ù‡Ù†ÙŠØ©'}</strong>
                    </div>
                    
                    <div class="advisor-effects">
                        <strong>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong>
                        <ul style="padding-right: 20px;">
                            ${analysis.butter.status === 'low' ? `
                                <li>Ù‚ØµÙˆØ± ÙÙŠ ØªØ£Ø«ÙŠØ± "Ø§Ù„ØªÙ‚ØµÙŠØ±" Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¬Ù„ÙˆØªÙŠÙ†</li>
                                <li>Ø¹Ø¬ÙŠÙ†Ø© Ø¬Ø§ÙØ© ÙˆÙ‡Ø´Ø© Ø¨Ø´ÙƒÙ„ Ù…ÙØ±Ø·</li>
                                <li>ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù†Ø¹ÙˆÙ…Ø© ÙÙŠ Ø§Ù„ÙÙ…</li>
                                <li>Ø¶Ø¹Ù ÙÙŠ ØªØ­Ø±ÙŠØ± Ø§Ù„Ù†ÙƒÙ‡Ø§Øª</li>
                            ` : `
                                <li>ØªØ£Ø«ÙŠØ± ØªÙ‚ØµÙŠØ± Ù…ÙØ±Ø· ÙŠØ¶Ø¹Ù Ø§Ù„Ø¨Ù†ÙŠØ©</li>
                                <li>Ø¹Ø¬ÙŠÙ†Ø© Ø¯Ù‡Ù†ÙŠØ© ÙŠØµØ¹Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§</li>
                                <li>Ø·Ø¨Ù‚Ø§Øª Ø²ÙŠØªÙŠØ© ÙˆÙ‚Ø¯ ØªÙ†ÙØµÙ„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø®Ø¨Ø²</li>
                                <li>Ø·Ø¹Ù… Ø¯Ù‡Ù†ÙŠ ØºØ§Ù…Ø±</li>
                            `}
                        </ul>
                    </div>
                    
                    <div class="advisor-solution">
                        <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                        ${analysis.butter.status === 'low' ? 
                            `Ø£Ø¶Ù ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ø²Ø¨Ø¯Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© ${SCIENTIFIC_RANGES.butter.ideal}%` :
                            `Ù‚Ù„Ù„ Ø§Ù„Ø²Ø¨Ø¯Ø© Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆØ§Ø²Ù† ÙÙŠ Ø§Ù„Ù…Ù„Ù…Ø³`
                        }
                    </div>
                </div>
            `;
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª
         */
        function getSugarsAdvice(recipe, analysis) {
            if (analysis.sugars.status === 'optimal') return '';
            
            const diff = recipe.sugarsPct - SCIENTIFIC_RANGES.sugars.ideal;
            const adjustGrams = (Math.abs(diff) / 100) * recipe.total;
            
            return `
                <div class="advisor-detail">
                    <h4>ğŸ¯ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª (${recipe.sugarsPct.toFixed(1)}%)</h4>
                    <div class="alert ${analysis.sugars.status === 'low' ? 'alert-warning' : 'alert-danger'}">
                        <strong>${analysis.sugars.status === 'low' ? 'âš ï¸ Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø­Ù„Ø§ÙˆØ© ÙˆØ§Ù„Ù„ÙˆÙ†' : 'âŒ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„Ø­Ù„Ø§ÙˆØ© ÙˆØ§Ù„Ù‡Ø´Ø§Ø´Ø©'}</strong>
                    </div>
                    
                    <div class="advisor-effects">
                        <strong>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong>
                        <ul style="padding-right: 20px;">
                            ${analysis.sugars.status === 'low' ? `
                                <li>Ø¶Ø¹Ù ÙÙŠ ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø§ÙŠØ§Ø±Ø¯ ÙˆØ§Ù„ØªÙ„ÙˆÙŠÙ†</li>
                                <li>Ù‚ØµÙˆØ± ÙÙŠ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø±Ø·ÙˆØ¨Ø©</li>
                                <li>Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø·Ø±Ø§ÙˆØ© ÙˆØ§Ù„Ù…Ù„Ù…Ø³ Ø§Ù„Ù†Ø§Ø¹Ù…</li>
                                <li>Ø­Ù„Ø§ÙˆØ© ØºÙŠØ± ÙƒØ§ÙÙŠØ©</li>
                            ` : `
                                <li>ØªØ£Ø«ÙŠØ± Ù…Ø·Ø±ÙŠ Ù…ÙØ±Ø· ÙŠØ¶Ø¹Ù Ø§Ù„Ø¨Ù†ÙŠØ©</li>
                                <li>Ø¹Ø¬ÙŠÙ†Ø© Ù„Ø²Ø¬Ø© ÙŠØµØ¹Ø¨ ÙØ±Ø¯Ù‡Ø§</li>
                                <li>Ù„ÙˆÙ† Ø¯Ø§ÙƒÙ† Ø¬Ø¯Ø§Ù‹ Ù‚Ø¯ ÙŠØµØ§Ø­Ø¨ Ù…Ø±Ø§Ø±Ø©</li>
                                <li>Ø­Ù„Ø§ÙˆØ© ØºØ§Ù…Ø±Ø© ØªØ·ØºÙ‰ Ø¹Ù„Ù‰ Ù†ÙƒÙ‡Ø© Ø§Ù„Ø¹Ø³Ù„</li>
                            `}
                        </ul>
                    </div>
                    
                    <div class="advisor-solution">
                        <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                        ${analysis.sugars.status === 'low' ? 
                            `Ø²Ø¯ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… (ÙŠÙØ¶Ù„ Ø§Ù„Ø¹Ø³Ù„ Ù„Ù„Ø­Ù„Ø§ÙˆØ© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©)` :
                            `Ù‚Ù„Ù„ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹Ø³Ù„ Ù„Ù„Ù†ÙƒÙ‡Ø©`
                        }
                    </div>
                </div>
            `;
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø¨ÙŠØ¶
         */
        function getEggsAdvice(recipe, analysis) {
            if (analysis.eggs.status === 'optimal') return '';
            
            const diff = recipe.eggsPct - SCIENTIFIC_RANGES.eggs.ideal;
            const adjustGrams = (Math.abs(diff) / 100) * recipe.total;
            
            return `
                <div class="advisor-detail">
                    <h4>ğŸ¥š Ø§Ù„Ø¨ÙŠØ¶ (${recipe.eggsPct.toFixed(1)}%)</h4>
                    <div class="alert ${analysis.eggs.status === 'low' ? 'alert-warning' : 'alert-danger'}">
                        <strong>${analysis.eggs.status === 'low' ? 'âš ï¸ Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø±Ø·ÙˆØ¨Ø© ÙˆØ§Ù„ØªÙ…Ø§Ø³Ùƒ' : 'âŒ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ÙƒØ«Ø§ÙØ©'}</strong>
                    </div>
                    
                    <div class="advisor-effects">
                        <strong>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong>
                        <ul style="padding-right: 20px;">
                            ${analysis.eggs.status === 'low' ? `
                                <li>Ø¶Ø¹Ù ÙÙŠ Ø§Ù„Ø§Ø³ØªØ­Ù„Ø§Ø¨ ÙˆØªÙ…Ø§Ø³Ùƒ Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø©</li>
                                <li>Ø¬ÙØ§Ù ÙˆÙ‚Ø§Ø¨Ù„ÙŠØ© Ù„Ù„ØªÙƒØ³Ø±</li>
                                <li>ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø®Ø¨Ø²</li>
                                <li>Ø¨Ù†ÙŠØ© Ù…Ø³Ø§Ù…ÙŠØ© Ø¶Ø¹ÙŠÙØ©</li>
                            ` : `
                                <li>ÙƒØ«Ø§ÙØ© Ø¹Ø§Ù„ÙŠØ© ÙˆÙ‚ÙˆØ§Ù… Ù…Ø·Ø§Ø·ÙŠ</li>
                                <li>Ø·Ø¹Ù… Ø¨ÙŠØ¶ Ù…Ø³ÙŠØ·Ø±</li>
                                <li>ØµØ¹ÙˆØ¨Ø© ÙÙŠ ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‚Ø±Ù…Ø´Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</li>
                                <li>Ù„ÙˆÙ† Ø¨Ø§Ù‡Øª Ø¨Ø³Ø¨Ø¨ ØªØ®ÙÙŠÙ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª</li>
                            `}
                        </ul>
                    </div>
                    
                    <div class="advisor-solution">
                        <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                        ${analysis.eggs.status === 'low' ? 
                            `Ø£Ø¶Ù ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ø¨ÙŠØ¶ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© ${SCIENTIFIC_RANGES.eggs.ideal}%` :
                            `Ù‚Ù„Ù„ Ø§Ù„Ø¨ÙŠØ¶ Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆØ§Ø²Ù† ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ù…`
                        }
                    </div>
                </div>
            `;
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØµÙˆØ¯Ø§
         */
        function getSodaAdvice(recipe, analysis) {
            if (analysis.soda.status === 'optimal') return '';
            
            const diff = recipe.sodaPct - SCIENTIFIC_RANGES.soda.ideal;
            const adjustGrams = (Math.abs(diff) / 100) * recipe.total;
            
            return `
                <div class="advisor-detail">
                    <h4>ğŸ§ª Ø§Ù„ØµÙˆØ¯Ø§ (${recipe.sodaPct.toFixed(2)}%)</h4>
                    <div class="alert ${analysis.soda.status === 'low' ? 'alert-warning' : 'alert-danger'}">
                        <strong>${analysis.soda.status === 'low' ? 'âš ï¸ Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ®ÙÙŠÙ ÙˆØ§Ù„Ù„ÙˆÙ†' : 'âŒ Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„Ø·Ø¹Ù… Ø§Ù„Ù‚Ù„ÙˆÙŠ'}</strong>
                    </div>
                    
                    <div class="advisor-effects">
                        <strong>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong>
                        <ul style="padding-right: 20px;">
                            ${analysis.soda.status === 'low' ? `
                                <li>ØªØ®ÙÙŠÙ ØºÙŠØ± ÙƒØ§Ù ÙˆØ¨Ù†ÙŠØ© ÙƒØ«ÙŠÙØ©</li>
                                <li>Ù„ÙˆÙ† Ø¨Ø§Ù‡Øª Ø¨Ø³Ø¨Ø¨ Ø¶Ø¹Ù ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø§ÙŠØ§Ø±Ø¯</li>
                                <li>pH Ù…Ù†Ø®ÙØ¶ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªÙ„ÙˆÙŠÙ†</li>
                                <li>Ù‚ÙˆØ§Ù… Ø«Ù‚ÙŠÙ„ ÙˆØºÙŠØ± Ù‡ÙˆØ§Ø¦ÙŠ</li>
                            ` : `
                                <li>Ø·Ø¹Ù… Ù‚Ù„ÙˆÙŠ (ØµØ§Ø¨ÙˆÙ†ÙŠ) ØºÙŠØ± Ù…Ø±ØºÙˆØ¨</li>
                                <li>Ù„ÙˆÙ† Ø¯Ø§ÙƒÙ† Ø¬Ø¯Ø§Ù‹ Ù‚Ø¯ ÙŠØµØ§Ø­Ø¨Ù‡ Ù…Ø±Ø§Ø±Ø©</li>
                                <li>ØªØ¢ÙƒÙ„ ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</li>
                                <li>Ù‚ÙˆØ§Ù… Ø®Ø´Ù† ÙˆÙ…Ø³Ø§Ù…ÙŠ Ø¨Ø´ÙƒÙ„ Ù…ÙØ±Ø·</li>
                            `}
                        </ul>
                    </div>
                    
                    <div class="advisor-solution">
                        <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                        ${analysis.soda.status === 'low' ? 
                            `Ø£Ø¶Ù ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… ØµÙˆØ¯Ø§ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© ${SCIENTIFIC_RANGES.soda.ideal}%` :
                            `Ù‚Ù„Ù„ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù…Ù‚Ø¯Ø§Ø± ${adjustGrams.toFixed(1)} Ø¬Ø±Ø§Ù… Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø·Ø¹Ù… Ø§Ù„Ù‚Ù„ÙˆÙŠ`
                        }
                    </div>
                </div>
            `;
        }
    
        /**
         * ØªØ­Ø¯ÙŠØ« ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…ÙƒØªØ¨Ø©
         */
        function updateLibraryTab() {
            const content = document.getElementById('library-content');
            if (!content) return;
            
            let html = '';
            
            if (savedRecipes.length > 0) {
                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø©
                const stats = calculateLibraryStats();
                
                html += `
                    <div class="alert alert-info">
                        <strong>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø©:</strong>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                            <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <strong>${stats.total}</strong></div>
                            <div>Ø§Ù„Ù†Ø§Ø¬Ø­Ø©: <strong class="score-high">${stats.successful} âœ…</strong></div>
                            <div>Ø§Ù„ÙØ§Ø´Ù„Ø©: <strong class="score-low">${stats.failed} âŒ</strong></div>
                            <div>Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <strong>${stats.avgRating}/5 â­</strong></div>
                            <div>Ù…ØªÙˆØ³Ø· Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¹Ù„Ù…ÙŠØ©: <strong>${stats.avgScientificScore}/100</strong></div>
                            <div>Ø§Ù„ØªÙˆØ§ÙÙ‚: <strong>${stats.agreementRate}%</strong></div>
                        </div>
                    </div>
                `;
                
                // Ø§Ù„ØªØ¹Ù„Ù… Ù…Ù† Ø§Ù„ØªØ¬Ø§Ø±Ø¨
                const learningInsights = analyzePersonalSuccessPatterns();
                if (learningInsights && learningInsights.insights.length > 0) {
                    const insightsSection = document.getElementById('learning-insights-section');
                    const insightsContent = document.getElementById('learning-insights-content');
                    
                    if (insightsSection && insightsContent) {
                        insightsSection.style.display = 'block';
                        
                        let insightsHtml = '<div class="learning-insights">';
                        insightsHtml += `<h4>ğŸ¯ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù†Ø¬Ø§Ø­ Ù…Ù† ØªØ¬Ø§Ø±Ø¨Ùƒ:</h4>`;
                        
                        learningInsights.insights.forEach(insight => {
                            insightsHtml += `
                                <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 5px; border-right: 3px solid #38a169;">
                                    <strong>${insight.component === 'soda' ? 'ğŸ§ª Ø§Ù„ØµÙˆØ¯Ø§' : 'ğŸ¥– Ø§Ù„Ø¯Ù‚ÙŠÙ‚'}:</strong>
                                    ${insight.finding}<br>
                                    <small style="color: #718096;">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ùƒ: ${insight.personalOptimal}%</small>
                                </div>
                            `;
                        });
                        
                        insightsHtml += `<p style="margin-top: 10px;"><small>Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ ${learningInsights.sampleSize} ÙˆØµÙØ© (${learningInsights.successfulCount} âœ… ${learningInsights.failedCount} âŒ)</small></p>`;
                        insightsHtml += '</div>';
                        
                        insightsContent.innerHTML = insightsHtml;
                    }
                } else {
                    const insightsSection = document.getElementById('learning-insights-section');
                    if (insightsSection) {
                        insightsSection.style.display = 'none';
                    }
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                savedRecipes.forEach((recipe, index) => {
                    const stars = 'â˜…'.repeat(recipe.rating || 0) + 'â˜†'.repeat(5 - (recipe.rating || 0));
                    const successBadge = recipe.success ? 'âœ… Ù†Ø¬Ø­Øª' : 'âŒ ÙØ´Ù„Øª';
                    const successClass = recipe.success ? 'score-high' : 'score-low';
                    const scientificScore = recipe.scientificScore || 0;
                    const scoreClass = scientificScore >= 80 ? 'score-high' : scientificScore >= 60 ? 'score-medium' : 'score-low';
                    const agreement = recipe.success === (scientificScore >= 60) ? 'âœ… Ù…ØªÙˆØ§ÙÙ‚' : 'âš ï¸ ØºÙŠØ± Ù…ØªÙˆØ§ÙÙ‚';
                    const agreementClass = recipe.success === (scientificScore >= 60) ? 'score-high' : 'score-low';
                    
                    html += `
                        <div class="method-card" style="margin: 15px 0;">
                            <div class="method-header">
                                <h4>${recipe.name || `ÙˆØµÙØ© ${index + 1}`}</h4>
                                <div>
                                    <span class="${successClass}" style="padding: 4px 10px; border-radius: 15px; margin: 0 5px;">${successBadge}</span>
                                    <span class="${scoreClass}" style="padding: 4px 10px; border-radius: 15px;">${scientificScore}/100</span>
                                </div>
                            </div>
                            <div style="margin: 10px 0; padding: 10px; background: #f7fafc; border-radius: 5px;">
                                <p style="margin: 5px 0;"><strong>Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ±:</strong></p>
                                <p style="margin: 5px 0; font-size: 0.9em; color: #4a5568;">
                                    Ø¯Ù‚ÙŠÙ‚: ${recipe.flour}Øº | Ø²Ø¨Ø¯Ø©: ${recipe.butter}Øº | Ø³ÙƒØ±: ${recipe.sugar}Øº | 
                                    Ø¹Ø³Ù„: ${recipe.honey}Øº | Ø¨ÙŠØ¶: ${recipe.eggs}Øº | ØµÙˆØ¯Ø§: ${recipe.soda}Øº
                                </p>
                            </div>
                            <p style="margin: 5px 0;">
                                <span class="${agreementClass}" style="padding: 3px 8px; border-radius: 10px; font-size: 0.85em;">${agreement}</span> | 
                                <span style="color: #f59e0b;">â­ ${stars}</span>
                            </p>
                            ${recipe.comment ? `<p style="margin: 10px 0; padding: 10px; background: #fffaf0; border-radius: 5px; border-right: 3px solid #d69e2e;">ğŸ’¬ ${recipe.comment}</p>` : ''}
                            <p style="font-size: 0.85em; color: #718096;">
                                ğŸ“… ${new Date(recipe.timestamp).toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' })}
                            </p>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-secondary" style="margin: 3px;" onclick="loadRecipe(${index})">ØªØ­Ù…ÙŠÙ„</button>
                                <button class="btn btn-danger" style="margin: 3px;" onclick="deleteRecipe(${index})">Ø­Ø°Ù</button>
                            </div>
                        </div>
                    `;
                });
            } else {
                html = `
                    <div class="alert alert-info">
                        <strong>ğŸ“š Ù…ÙƒØªØ¨ØªÙƒ ÙØ§Ø±ØºØ©</strong>
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØµÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯. Ø§Ø­ÙØ¸ ÙˆØµÙØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† ØªØ¨ÙˆÙŠØ¨ "Ù…Ø­Ù„Ù„ Ø§Ù„ÙˆØµÙØ§Øª"!</p>
                    </div>
                `;
            }
            
            content.innerHTML = html;
        }
    
        /**
         * Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø©
         */
        function calculateLibraryStats() {
            const total = savedRecipes.length;
            const successful = savedRecipes.filter(r => r.success === true).length;
            const failed = savedRecipes.filter(r => r.success === false).length;
            
            const avgRating = total > 0 ? 
                savedRecipes.reduce((sum, r) => sum + (r.rating || 0), 0) / total : 0;
            
            const avgScientificScore = total > 0 ? 
                savedRecipes.reduce((sum, r) => sum + (r.scientificScore || 0), 0) / total : 0;
            
            // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙˆØ§ÙÙ‚ Ø¨ÙŠÙ† Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø´Ø®ØµÙŠ ÙˆØ§Ù„Ø¹Ù„Ù…ÙŠ
            const agreed = savedRecipes.filter(r => 
                r.success === (r.scientificScore >= 60)
            ).length;
            
            const agreementRate = total > 0 ? ((agreed / total) * 100).toFixed(1) : 0;
            
            return {
                total,
                successful,
                failed,
                avgRating: avgRating.toFixed(1),
                avgScientificScore: avgScientificScore.toFixed(1),
                agreementRate
            };
        }
    
        /**
         * ØªØ­Ù„ÙŠÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ø´Ø®ØµÙŠØ©
         */
        function analyzePersonalSuccessPatterns() {
            const successful = savedRecipes.filter(r => r.success === true);
            const failed = savedRecipes.filter(r => r.success === false);
            
            if (successful.length < 2 && failed.length < 2) {
                return null; // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©
            }
            
            const insights = [];
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ¯Ø§
            if (successful.length >= 2) {
                const avgSuccessfulSoda = successful.reduce((sum, r) => {
                    const total = r.flour + r.butter + r.sugar + r.honey + r.eggs + r.soda;
                    return sum + (r.soda / total) * 100;
                }, 0) / successful.length;
                
                if (failed.length >= 2) {
                    const avgFailedSoda = failed.reduce((sum, r) => {
                        const total = r.flour + r.butter + r.sugar + r.honey + r.eggs + r.soda;
                        return sum + (r.soda / total) * 100;
                    }, 0) / failed.length;
                    
                    if (Math.abs(avgSuccessfulSoda - avgFailedSoda) > 0.1) {
                        insights.push({
                            component: 'soda',
                            finding: avgSuccessfulSoda > avgFailedSoda ? 
                                'ÙˆØµÙØ§ØªÙƒ Ø§Ù„Ù†Ø§Ø¬Ø­Ø© ØªØ³ØªØ®Ø¯Ù… ØµÙˆØ¯Ø§ Ø£ÙƒØ«Ø±' :
                                'ÙˆØµÙØ§ØªÙƒ Ø§Ù„Ù†Ø§Ø¬Ø­Ø© ØªØ³ØªØ®Ø¯Ù… ØµÙˆØ¯Ø§ Ø£Ù‚Ù„',
                            personalOptimal: avgSuccessfulSoda.toFixed(2),
                            confidence: 'high'
                        });
                    }
                }
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù‚ÙŠÙ‚
            if (successful.length >= 2) {
                const avgSuccessfulFlour = successful.reduce((sum, r) => {
                    const total = r.flour + r.butter + r.sugar + r.honey + r.eggs + r.soda;
                    return sum + (r.flour / total) * 100;
                }, 0) / successful.length;
                
                if (Math.abs(avgSuccessfulFlour - SCIENTIFIC_RANGES.flour.ideal) > 2) {
                    insights.push({
                        component: 'flour',
                        finding: `ØªÙØ¶Ù„ Ù†Ø³Ø¨Ø© Ø¯Ù‚ÙŠÙ‚ ${avgSuccessfulFlour.toFixed(1)}% Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ${SCIENTIFIC_RANGES.flour.ideal}% Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©`,
                        personalOptimal: avgSuccessfulFlour.toFixed(1),
                        confidence: 'medium'
                    });
                }
            }
            
            return {
                insights: insights,
                sampleSize: successful.length + failed.length,
                successfulCount: successful.length,
                failedCount: failed.length
            };
        }
    
        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¹Ø§Ù…Ø© =====
        
        /**
         * ØªØ­Ù…ÙŠÙ„ ÙˆØµÙØ© Ù…Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø©
         */
        window.loadRecipe = function(index) {
            if (index < 0 || index >= savedRecipes.length) return;
            
            const recipe = savedRecipes[index];
            
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (flourInput) flourInput.value = recipe.flour;
            if (butterInput) butterInput.value = recipe.butter;
            if (sugarInput) sugarInput.value = recipe.sugar;
            if (honeyInput) honeyInput.value = recipe.honey;
            if (eggsInput) eggsInput.value = recipe.eggs;
            if (sodaInput) sodaInput.value = recipe.soda;
            
            analyzeRecipe();
            alert(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ "${recipe.name}"`);
            
            // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„
            const analyzerTab = document.querySelector('[data-tab="analyzer"]');
            if (analyzerTab) {
                analyzerTab.click();
            }
        };
    
        /**
         * Ø­Ø°Ù ÙˆØµÙØ© Ù…Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø©
         */
        window.deleteRecipe = function(index) {
            if (index < 0 || index >= savedRecipes.length) return;
            
            const recipe = savedRecipes[index];
            const confirmDelete = confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù "${recipe.name}"ØŸ\n\nÙ‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.`);
            
            if (confirmDelete) {
                savedRecipes.splice(index, 1);
                saveRecipesToStorage();
                updateLibraryTab();
                alert('âœ… ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­');
            }
        };
    
        /**
         * Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
         */
        function resetForm() {
            const flourInput = document.getElementById('flour');
            const butterInput = document.getElementById('butter');
            const sugarInput = document.getElementById('sugar');
            const honeyInput = document.getElementById('honey');
            const eggsInput = document.getElementById('eggs');
            const sodaInput = document.getElementById('soda');
            
            if (flourInput) flourInput.value = '500';
            if (butterInput) butterInput.value = '120';
            if (sugarInput) sugarInput.value = '200';
            if (honeyInput) honeyInput.value = '100';
            if (eggsInput) eggsInput.value = '95';
            if (sodaInput) sodaInput.value = '5.5';
            
            analyzeRecipe();
        }
    
        // ===== Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ =====
        
        function showSolution(problem) {
            const solutions = {
                sticky: {
                    title: "Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© Ø§Ù„Ù„Ø²Ø¬Ø©",
                    causes: [
                        "Ù†Ù‚Øµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ù†Ø³Ø¨Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„",
                        "Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø³Ù„ Ø£Ùˆ Ø§Ù„Ø³ÙƒØ± Ø¨Ø´ÙƒÙ„ Ù…ÙØ±Ø·", 
                        "Ø¹Ø¯Ù… ØªØ¨Ø±ÙŠØ¯ Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© ÙƒØ§ÙÙŠØ©",
                        "Ù†Ù‚Øµ Ø§Ù„Ø¯Ù‡ÙˆÙ† (Ø§Ù„Ø²Ø¨Ø¯Ø©)"
                    ],
                    solutions: [
                        "Ø£Ø¶Ù 10-15% Ø¯Ù‚ÙŠÙ‚ Ø¥Ø¶Ø§ÙÙŠ",
                        "Ø¨Ø±Ø¯ Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© 60 Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 30",
                        "Ø§Ø³ØªØ®Ø¯Ù… Ø¯Ù‚ÙŠÙ‚Ø§Ù‹ Ø¥Ø¶Ø§ÙÙŠØ§Ù‹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙØ±Ø¯",
                        "Ø²Ø¯ Ø§Ù„Ø²Ø¨Ø¯Ø© Ø¨Ù†Ø³Ø¨Ø© 5% Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ù…"
                    ],
                    scientific: "Ø§Ù„Ø¹Ø³Ù„ ØºÙ†ÙŠ Ø¨Ø§Ù„ÙØ±ÙƒØªÙˆØ² Ø§Ù„Ø°ÙŠ ÙŠØ²ÙŠØ¯ Ø§Ù„Ù„Ø²ÙˆØ¬Ø©. Ø§Ù„ØªØ¨Ø±ÙŠØ¯ ÙŠØµÙ„Ø¨ Ø§Ù„Ø¯Ù‡ÙˆÙ† ÙˆÙŠÙ‚Ù„Ù„ Ø§Ù„Ø§Ù„ØªØµØ§Ù‚."
                },
                dry: {
                    title: "Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¹Ø¬ÙŠÙ†Ø© Ø§Ù„Ø¬Ø§ÙØ©",
                    causes: [
                        "Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ Ù…ÙØ±Ø·",
                        "Ù†Ù‚Øµ Ø§Ù„Ø¹Ø³Ù„ Ø£Ùˆ Ø§Ù„Ø³ÙƒØ±",
                        "Ù†Ù‚Øµ Ø§Ù„Ø¨ÙŠØ¶ Ø£Ùˆ Ø§Ù„Ø²Ø¨Ø¯Ø©",
                        "Ø®Ø¨Ø² Ø²Ø§Ø¦Ø¯ Ø¹Ù† Ø§Ù„Ù„Ø§Ø²Ù…"
                    ],
                    solutions: [
                        "Ù‚Ù„Ù„ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ù†Ø³Ø¨Ø© 10-15%",
                        "Ø²Ø¯ Ø§Ù„Ø¹Ø³Ù„ Ø¨Ù†Ø³Ø¨Ø© 5-8% Ù„Ù„ØªØ±Ø·ÙŠØ¨",
                        "Ø£Ø¶Ù Ø¨ÙŠØ¶Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ø£Ùˆ Ø²Ø¨Ø¯Ø©",
                        "Ù‚Ù„Ù„ ÙˆÙ‚Øª Ø§Ù„Ø®Ø¨Ø² 1-2 Ø¯Ù‚ÙŠÙ‚Ø©"
                    ],
                    scientific: "Ø§Ù„Ø¹Ø³Ù„ ÙˆØ§Ù„Ø³ÙƒØ± Ù…ÙˆØ§Ø¯ Ø§Ø³ØªØ±Ø·Ø§Ø¨ÙŠØ© ØªÙ…ØªØµ Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ø¬Ùˆ. Ø§Ù„Ø¨ÙŠØ¶ ÙŠØ²ÙŠØ¯ Ø§Ù„Ø±Ø·ÙˆØ¨Ø© ÙˆØ§Ù„ØªÙ…Ø§Ø³Ùƒ."
                },
                hard: {
                    title: "Ø­Ù„ÙˆÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ù‚Ø§Ø³ÙŠØ©", 
                    causes: [
                        "Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ±",
                        "Ù†Ù‚Øµ Ø§Ù„Ø¯Ù‡ÙˆÙ† (Ø§Ù„Ø²Ø¨Ø¯Ø©)",
                        "Ù†Ù‚Øµ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª Ø§Ù„Ù…Ø±Ø·Ø¨Ø©",
                        "Ø®Ø¨Ø² Ø·ÙˆÙŠÙ„ Ø£Ùˆ Ø­Ø±Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ©"
                    ],
                    solutions: [
                        "Ù‚Ù„Ù„ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ 10% ÙˆØ§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø§Ù„Ø³ÙˆØ§Ø¦Ù„",
                        "Ø²Ø¯ Ø§Ù„Ø²Ø¨Ø¯Ø© 8-12% Ù„Ù„Ø·Ø±Ø§ÙˆØ©",
                        "Ø²Ø¯ Ø§Ù„Ø¹Ø³Ù„ 5% Ù„Ù„ØªØ±Ø·ÙŠØ¨",
                        "Ø§Ø®Ø¨Ø² Ø¹Ù„Ù‰ 180Â°C Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 190Â°C"
                    ],
                    scientific: "Ø§Ù„Ø¯Ù‡ÙˆÙ† ØªÙ‚Ø·Ø¹ Ø´Ø¨ÙƒØ© Ø§Ù„Ø¬Ù„ÙˆØªÙŠÙ†. Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª ØªÙ…Ù†Ø¹ ØªÙƒÙˆÙŠÙ† Ø¨Ù†ÙŠØ© ØµÙ„Ø¨Ø©."
                },
                bitter: {
                    title: "Ø­Ù„ÙˆÙ„ Ø§Ù„Ø·Ø¹Ù… Ø§Ù„Ù‚Ù„ÙˆÙŠ",
                    causes: [
                        "Ø²ÙŠØ§Ø¯Ø© ØµÙˆØ¯Ø§ Ø§Ù„Ø®Ø¨Ø²",
                        "Ø¹Ø³Ù„ ØºÙŠØ± ÙƒØ§Ù Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØµÙˆØ¯Ø§", 
                        "ØªØ³Ø®ÙŠÙ† Ø²Ø§Ø¦Ø¯ Ù„Ù„Ø¹Ø³Ù„ Ù…Ø¹ Ø§Ù„ØµÙˆØ¯Ø§",
                        "Ø¹Ø³Ù„ Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ø­Ù…ÙˆØ¶Ø©"
                    ],
                    solutions: [
                        "Ù‚Ù„Ù„ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù†Ø³Ø¨Ø© 20-30%",
                        "Ø²Ø¯ Ø§Ù„Ø¹Ø³Ù„ 10-15% Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©",
                        "ØªØ¬Ù†Ø¨ ØªØ³Ø®ÙŠÙ† Ø§Ù„Ø¹Ø³Ù„ ÙÙˆÙ‚ 120Â°C",
                        "Ø§Ø®ØªØ± Ø¹Ø³Ù„ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ­Ù…Ø¶ÙŠ"
                    ],
                    scientific: "Ø§Ù„ØµÙˆØ¯Ø§ Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© ØªØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ ÙƒØ±Ø¨ÙˆÙ†Ø§Øª Ø§Ù„ØµÙˆØ¯ÙŠÙˆÙ… Ø°Ø§Øª Ø§Ù„Ø·Ø¹Ù… Ø§Ù„Ù‚Ù„ÙˆÙŠ. Ø§Ù„Ø¹Ø³Ù„ Ø§Ù„Ø­Ù…Ø¶ÙŠ ÙŠØ¹Ø§Ø¯Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªØ£Ø«ÙŠØ±."
                },
                pale: {
                    title: "Ø­Ù„ÙˆÙ„ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¨Ø§Ù‡Øª",
                    causes: [
                        "Ù†Ù‚Øµ ØµÙˆØ¯Ø§ Ø§Ù„Ø®Ø¨Ø²",
                        "Ø¹Ø³Ù„ ØºÙŠØ± ÙƒØ§Ù Ù„ØªÙØ§Ø¹Ù„ Ù…Ø§ÙŠØ§Ø±Ø¯",
                        "Ø­Ø±Ø§Ø±Ø© Ø®Ø¨Ø² Ù…Ù†Ø®ÙØ¶Ø©",
                        "ÙˆÙ‚Øª Ø®Ø¨Ø² ØºÙŠØ± ÙƒØ§Ù"
                    ],
                    solutions: [
                        "Ø²Ø¯ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù†Ø³Ø¨Ø© 25-40%",
                        "Ø²Ø¯ Ø§Ù„Ø¹Ø³Ù„ 8-12% Ù„Ù„ØªÙ„ÙˆÙŠÙ†",
                        "Ø§Ø®Ø¨Ø² Ø¹Ù„Ù‰ 190-200Â°C",
                        "Ø²Ø¯ ÙˆÙ‚Øª Ø§Ù„Ø®Ø¨Ø² 1-2 Ø¯Ù‚ÙŠÙ‚Ø©"
                    ],
                    scientific: "Ø§Ù„ØµÙˆØ¯Ø§ ØªØ±ÙØ¹ Ø§Ù„Ù€ pH Ù…Ù…Ø§ ÙŠØ³Ø±Ø¹ ØªÙØ§Ø¹Ù„ Ù…Ø§ÙŠØ§Ø±Ø¯. Ø§Ù„Ø¹Ø³Ù„ ÙŠÙˆÙØ± Ø³ÙƒØ±ÙŠØ§Øª Ù…Ø®ØªØ²Ù„Ø© Ù„Ù„ØªÙ„ÙˆÙŠÙ†."
                }
            };
    
            const solution = solutions[problem];
            if (!solution) return;
            
            let html = `
                <h3>${solution.title}</h3>
                <div class="alert alert-info">
                    <strong>Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:</strong>
                    <ul style="padding-right: 20px; margin: 10px 0;">
                        ${solution.causes.map(cause => `<li>${cause}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="solution-card">
                    <strong>ğŸ› ï¸ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:</strong>
                    <ul style="padding-right: 20px; margin: 10px 0;">
                        ${solution.solutions.map(sol => `<li>${sol}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="alert alert-success">
                    <strong>ğŸ§ª Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ø¹Ù„Ù…ÙŠ:</strong> ${solution.scientific}
                </div>
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ù†ØµØ§Ø¦Ø­ Ø´Ø®ØµÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØµÙØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (currentRecipe) {
                html += `
                    <div class="alert alert-warning">
                        <strong>ğŸ“Š ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ ÙˆØµÙØªÙƒ:</strong>
                        ${getPersonalizedAdvice(problem, currentRecipe)}
                    </div>
                `;
            }
    
            const solutionContent = document.getElementById('solution-content');
            if (solutionContent) {
                solutionContent.innerHTML = html;
            }
            
            const step1 = document.getElementById('step1');
            const step2 = document.getElementById('step2');
            if (step1) step1.classList.remove('active');
            if (step2) step2.classList.add('active');
        }
    
        /**
         * Ù†ØµØ§Ø¦Ø­ Ø´Ø®ØµÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
         */
        function getPersonalizedAdvice(problem, recipe) {
            const total = recipe.total;
            
            switch(problem) {
                case 'sticky':
                    const addFlour = (total * 0.12).toFixed(1);
                    return `Ø£Ø¶Ù ${addFlour}Øº Ø¯Ù‚ÙŠÙ‚ (12%) Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ù….`;
                    
                case 'dry':
                    const addHoney = (total * 0.07).toFixed(1);
                    return `Ø£Ø¶Ù ${addHoney}Øº Ø¹Ø³Ù„ (7%) Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø±Ø·ÙˆØ¨Ø©.`;
                    
                case 'hard':
                    const addButter = (total * 0.10).toFixed(1);
                    return `Ø²Ø¯ Ø§Ù„Ø²Ø¨Ø¯Ø© Ø¨Ù…Ù‚Ø¯Ø§Ø± ${addButter}Øº (10%) Ù„Ù„Ø·Ø±Ø§ÙˆØ©.`;
                    
                case 'bitter':
                    const reduceSoda = (recipe.soda * 0.25).toFixed(1);
                    return `Ù‚Ù„Ù„ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù…Ù‚Ø¯Ø§Ø± ${reduceSoda}Øº (25%) Ù„Ù„ØªØ®Ù„Øµ Ù…Ù† Ø§Ù„Ø·Ø¹Ù… Ø§Ù„Ù‚Ù„ÙˆÙŠ.`;
                    
                case 'pale':
                    const addSoda = (recipe.soda * 0.35).toFixed(1);
                    return `Ø²Ø¯ Ø§Ù„ØµÙˆØ¯Ø§ Ø¨Ù…Ù‚Ø¯Ø§Ø± ${addSoda}Øº (35%) Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù„ÙˆÙ†.`;
                    
                default:
                    return "Ø­Ù„Ù„ ÙˆØµÙØªÙƒ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ØµØ§Ø¦Ø­ Ù…Ø®ØµØµØ©.";
            }
        }
    
        // ===== Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© =====
        console.log('%câœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Medovik Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!', 'color: #38a169; font-size: 16px; font-weight: bold;');
        console.log('%cğŸ”¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© ØµØ­ÙŠØ­Ø© 100%', 'color: #3182ce; font-size: 14px;');
        console.log('%cğŸ“Š Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡Ø§', 'color: #38a169; font-size: 14px;');
        
    </script>
</body>
</html>