<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Medovik Smart Bakery OS</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header class="app-header">
    <h1>Medovik Smart Bakery OS</h1>
    <div class="subtitle">ุงููุฎุชุจุฑ ุงูุฐูู ูุชุญููู ูุชุญุณูู ุนุฌููุฉ ุงูููุฏูููู ูุงูุญุดูุงุช</div>
  </header>

  <nav class="tabs-nav">
    <button class="tab-btn active" data-tab="lab">๐ฌ ุงููุญูู ุงูุนููู</button>
    <button class="tab-btn" data-tab="engineering">๐งฎ ุงูููุฏุณุฉ</button>
    <button class="tab-btn" data-tab="filling">๐ฐ ุงูุญุดูุฉ ุงูุฐููุฉ</button>
    <button class="tab-btn" data-tab="processing">โ๏ธ ุงููุนุงูุฌุฉ</button>
  </nav>

  <main class="tabs-container">

    <!-- The Lab -->
    <section id="lab" class="tab-panel active">
      <div class="panel-grid">
        <div class="card">
          <h3>ููุงุฏูุฑ ุงูุนุฌูู (ุฌู)</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="flour">ุฏููู</label>
              <input type="number" id="flour" min="0" step="1" value="500">
            </div>
            <div class="input-group">
              <label for="butter">ุฒุจุฏุฉ</label>
              <input type="number" id="butter" min="0" step="1" value="120">
            </div>
            <div class="input-group">
              <label for="sugar">ุณูุฑ</label>
              <input type="number" id="sugar" min="0" step="1" value="200">
            </div>
            <div class="input-group">
              <label for="honey">ุนุณู</label>
              <input type="number" id="honey" min="0" step="1" value="100">
            </div>
            <div class="input-group">
              <label for="eggs">ุจูุถ</label>
              <input type="number" id="eggs" min="0" step="1" value="95">
            </div>
            <div class="input-group">
              <label for="soda">ุตูุฏุง ุงูุฎุจุฒ</label>
              <input type="number" id="soda" min="0" step="0.1" value="5.5">
            </div>
          </div>

          <div class="hr"></div>

          <h4>ูุฑููุฉ ุงูุนุณู</h4>
          <div class="caramelization-grid">
            <label class="switch">
              <input type="checkbox" id="caramelization-enabled">
              <span>ุชูุนูู ุงููุฑููุฉ</span>
            </label>
            <div class="input-group small">
              <label for="caramelization-Tpre">T_pre (ยฐC)</label>
              <input type="number" id="caramelization-Tpre" min="105" max="110" step="1" value="108">
            </div>
            <div class="input-group small">
              <label for="caramelization-tpre">t_pre (ุฏูููุฉ)</label>
              <input type="number" id="caramelization-tpre" min="1.5" max="3" step="0.1" value="2.0">
            </div>
            <div class="input-group small">
              <label for="caramelization-evap">evap (ุชุจุฎูุฑ)</label>
              <input type="number" id="caramelization-evap" min="0.05" max="0.10" step="0.01" value="0.08">
            </div>
          </div>

          <div class="buttons-row">
            <button class="btn primary" id="analyze-btn">ุชุญููู ุงููุตูุฉ</button>
          </div>
        </div>

        <div class="card">
          <h3>ูุชุงุฆุฌ ุงูุชุญููู</h3>
          <div id="analysis-results-wrapper"></div>
          <div id="advisor-report-container" class="mt-10"></div>
        </div>

        <div class="card">
          <h3>ููุญุฉ ุงููุทุจุฎ</h3>
          <div id="kitchen-dashboard-container"></div>
        </div>

        <div class="card">
          <h3>ููุชุจุฉ ุงููุตูุงุช (ุงูุนุฌูู)</h3>
          <div class="buttons-row">
            <button class="btn" id="save-recipe-btn">ุญูุธ ุงููุตูุฉ ุงูุญุงููุฉ</button>
            <button class="btn" id="export-recipe-btn">ุชุตุฏูุฑ</button>
            <label class="btn">
              ุงุณุชูุฑุงุฏ
              <input type="file" id="import-recipe-input" style="display:none;">
            </label>
          </div>
          <div id="recipe-library-container" class="mt-10"></div>
        </div>
      </div>
    </section>

    <!-- Engineering -->
    <section id="engineering" class="tab-panel">
      <div class="panel-grid">
        <div class="card">
          <h3>ูุถุน ุงูุญุณุงุจ</h3>
          <div id="scaling-mode-toggle" class="toggle-row">
            <button class="btn btn-toggle active" data-mode="normal">ุนุงุฏู</button>
            <button class="btn btn-toggle" data-mode="advanced">ูุชูุฏู</button>
            <button class="btn btn-toggle" data-mode="reverse">ุนูุณู</button>
          </div>
        </div>

        <!-- Normal mode -->
        <div class="card scaling-mode-panel active" data-panel="normal">
          <h3>ุทุจูุฉ: ูุณุงุญุฉ ร ุณูุงูุฉ</h3>
          <div class="subgrid">
            <div>
              <h4>ุดูู ุงูุตูููุฉ</h4>
              <div class="pan-shape-selector" data-target="normal">
                <label><input type="radio" name="pan-shape-normal" value="round" checked> ุฏุงุฆุฑูุฉ</label>
                <label><input type="radio" name="pan-shape-normal" value="rectangle"> ูุณุชุทููุฉ</label>
              </div>
              <div id="pan-inputs-normal" class="input-inline">
                <div class="input-group">
                  <label for="pan-dim1-normal">ุงููุทุฑ (ุณู)</label>
                  <input type="number" id="pan-dim1-normal" value="24" min="10" max="50">
                </div>
              </div>
              <div class="input-group small">
                <label for="layer-thickness-normal">ุงูุณูุงูุฉ (ูู)</label>
                <input type="number" id="layer-thickness-normal" value="2" min="1" max="5" step="0.5">
              </div>
            </div>
            <div class="buttons-col">
              <button class="btn primary" id="calculate-layers-normal-btn">ุงุญุณุจ ุงูุทุจูุงุช</button>
            </div>
          </div>
        </div>

        <!-- Advanced mode -->
        <div class="card scaling-mode-panel" data-panel="advanced">
          <h3>ุชุญุฌูู ูุชูุฏู</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="target-layer-weight">ูุฒู ุงูุทุจูุฉ (ุฌู)</label>
              <input type="number" id="target-layer-weight" min="50" max="300" step="1" value="120">
            </div>
            <div class="input-group">
              <label for="target-layer-count">ุนุฏุฏ ุงูุทุจูุงุช</label>
              <input type="number" id="target-layer-count" min="1" max="20" step="1" value="8">
            </div>
            <div class="input-group">
              <label for="extra-for-crumbs">ูุงูุฏ/ูุชุงุช (%)</label>
              <input type="number" id="extra-for-crumbs" min="0" max="30" step="1" value="10">
            </div>
          </div>
          <button class="btn primary" id="calculate-scaling-advanced-btn">ุชุญุฌูู ูุชูุฏู</button>
        </div>

        <!-- Reverse mode -->
        <div class="card scaling-mode-panel" data-panel="reverse">
          <h3>ุญุณุงุจ ุงูููุงุฏูุฑ ุงููุทููุจุฉ</h3>
          <div class="subgrid">
            <div>
              <h4>ุดูู ุงูุตูููุฉ</h4>
              <div class="pan-shape-selector" data-target="reverse">
                <label><input type="radio" name="pan-shape-reverse" value="round" checked> ุฏุงุฆุฑูุฉ</label>
                <label><input type="radio" name="pan-shape-reverse" value="rectangle"> ูุณุชุทููุฉ</label>
              </div>
              <div id="pan-inputs-reverse" class="input-inline">
                <div class="input-group">
                  <label for="pan-dim1-reverse">ุงููุทุฑ (ุณู)</label>
                  <input type="number" id="pan-dim1-reverse" value="24" min="10" max="50">
                </div>
              </div>
              <div class="input-group small">
                <label for="layer-thickness-reverse">ุงูุณูุงูุฉ (ูู)</label>
                <input type="number" id="layer-thickness-reverse" value="2" min="1" max="5" step="0.5">
              </div>
              <div class="input-group small">
                <label for="target-layers-reverse">ุนุฏุฏ ุงูุทุจูุงุช</label>
                <input type="number" id="target-layers-reverse" value="8" min="1" max="20">
              </div>
            </div>
            <div class="buttons-col">
              <button class="btn primary" id="calculate-scaling-reverse-btn">ุงุญุณุจ ุงูููุงุฏูุฑ</button>
            </div>
          </div>
        </div>

        <!-- ูุนุงูุฑุฉ ุงููุซุงูุฉ -->
        <div class="card">
          <h3>โ๏ธ ูุนุงูุฑุฉ ุงููุซุงูุฉ</h3>
          <p class="muted">ููุชุงุฆุฌ ุฏูููุฉุ ูู ุจููุงุณ ูุซุงูุฉ ุนุฌููู ุงููุนูู</p>
          <div class="input-grid">
            <div class="input-group">
              <label for="calibrate-weight">ูุฒู ุงูุทุจูุฉ ุงููุฎุจูุฒุฉ (ุฌู)</label>
              <input type="number" id="calibrate-weight" min="50" max="500" value="120">
            </div>
            <div class="input-group">
              <label for="calibrate-diameter">ูุทุฑ ุงูุตูููุฉ (ุณู)</label>
              <input type="number" id="calibrate-diameter" value="24" min="10" max="50">
            </div>
            <div class="input-group">
              <label for="calibrate-thickness">ุณูุงูุฉ ุงูุทุจูุฉ (ูู)</label>
              <input type="number" id="calibrate-thickness" value="2" min="1" max="5" step="0.5">
            </div>
          </div>
          <button class="btn primary" id="calibrate-density-btn">ูุนุงูุฑุฉ ุงููุซุงูุฉ</button>
          <div id="calibration-result"></div>
        </div>

        <div class="card">
          <h3>ูุชุงุฆุฌ ุงูููุฏุณุฉ</h3>
          <div id="scaling-results-container"></div>
        </div>
      </div>
    </section>

    <!-- Smart Filling -->
    <section id="filling" class="tab-panel">
      <div class="panel-grid">
        <div class="card">
          <h3>ููุงุตูุงุช ุงูุตูููุฉ ูุนุฏุฏ ุงูุทุจูุงุช</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="filling-pan-shape">ุดูู ุงูุตูููุฉ</label>
              <select id="filling-pan-shape">
                <option value="round" selected>ุฏุงุฆุฑูุฉ</option>
                <option value="rectangle">ูุณุชุทููุฉ</option>
              </select>
            </div>
            <div class="input-group">
              <label for="filling-pan-dim1">ุงููุทุฑ/ุงูุทูู (ุณู)</label>
              <input type="number" id="filling-pan-dim1" min="10" max="60" value="24">
            </div>
            <div class="input-group">
              <label for="filling-pan-dim2">ุงูุนุฑุถ (ุณู)</label>
              <input type="number" id="filling-pan-dim2" min="10" max="60" placeholder="ูููุณุชุทููุฉ ููุท">
            </div>
            <div class="input-group">
              <label for="filling-layers">ุนุฏุฏ ุทุจูุงุช ุงูููู</label>
              <input type="number" id="filling-layers" min="1" max="20" value="8">
            </div>
            <div class="input-group">
              <label for="filling-thickness">ุณูุงูุฉ ุงูุญุดู ููู ุทุจูุฉ (ูู)</label>
              <input type="number" id="filling-thickness" min="2" max="10" step="0.5" value="5">
            </div>
          </div>
        </div>

        <div class="card">
          <h3>ููููุงุช ุงูุญุดูุฉ (ุฅุฏุฎุงู ุญุฑ)</h3>
          <div id="filling-dynamic-ingredients"></div>
          <div class="input-grid" style="margin-top:8px;">
            <div class="input-group">
              <label for="sweetness-reduction">ุชูููู ุงูุญูุงูุฉ (%)</label>
              <input type="range" id="sweetness-reduction" min="0" max="50" step="5" value="0">
              <small class="muted">ุงููููุฉ ุงูุญุงููุฉ: <span id="sweetness-reduction-value">0%</span></small>
            </div>
          </div>
          <div class="buttons-row">
            <button class="btn primary" id="generate-protocol-btn">ุชูููุฏ ุจุฑูุชูููู ุงูุชุญุถูุฑ</button>
            <button class="btn" id="save-filling-btn">ุญูุธ ูุฐู ุงูุญุดูุฉ</button>
          </div>
        </div>

        <div class="card">
          <h3>ูุชุงุฆุฌ ุงูุญุดูุฉ</h3>
          <div id="filling-results-container"></div>
        </div>

        <div class="card">
          <h3>ุจุฑูุชูููู ุงูุชุญุถูุฑ</h3>
          <div id="preparation-protocol-container"></div>
        </div>

        <div class="card">
          <h3>ููุชุจุฉ ุงูุญุดูุงุช ุงููุฎุตุตุฉ</h3>
          <div id="filling-library-container"></div>
        </div>
      </div>
    </section>

    <!-- Processing -->
    <section id="processing" class="tab-panel">
      <div class="panel-grid">

        <div class="card">
          <h3>๐ ุทุฑููุฉ ุชุญุถูุฑ ุงูุนุฌูู</h3>
          <div class="toggle-row" style="margin-bottom: 15px;">
            <button class="btn btn-toggle active" id="method-scientific">ุงูุทุฑููุฉ ุงูููุงุณูููุฉ (ุชูุตูุฉ ุงูุดูู)</button>
            <button class="btn btn-toggle" id="method-allinone">ุทุฑููุฉ ุงููู ูู ูุงุญุฏ</button>
          </div>
          <div id="dough-method-container">
            <!-- ุณูุชู ููุคู ุจูุงุณุทุฉ UI.js -->
          </div>
        </div>

        <div class="card">
          <h3>ุญุงุณุจุฉ ุงูุชูุจุฑูุฌ</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="tempering-egg-mass">ูุฒู ุงูุจูุถ (ุฌู)</label>
              <input type="number" id="tempering-egg-mass" min="1" max="1000" step="1" value="150">
            </div>
            <div class="input-group">
              <label for="tempering-egg-temp">ุญุฑุงุฑุฉ ุงูุจูุถ (ยฐC)</label>
              <input type="number" id="tempering-egg-temp" min="0" max="30" step="0.5" value="20">
            </div>
            <div class="input-group">
              <label for="tempering-liquid-mass">ูุฒู ุงูุฎููุท ุงูุณุงุฎู (ุฌู)</label>
              <input type="number" id="tempering-liquid-mass" min="1" max="5000" step="1" value="600">
            </div>
            <div class="input-group">
              <label for="tempering-liquid-temp">ุญุฑุงุฑุฉ ุงูุฎููุท (ยฐC)</label>
              <input type="number" id="tempering-liquid-temp" min="60" max="120" step="1" value="85">
            </div>
            <div class="input-group">
              <label for="tempering-batch-count">ุนุฏุฏ ุงูุฏูุนุงุช</label>
              <input type="number" id="tempering-batch-count" min="2" max="10" step="1" value="5">
            </div>
          </div>
          <div class="buttons-row">
            <button class="btn primary" id="calculate-tempering-btn">ุญุณุงุจ ุงูุชูุจุฑูุฌ</button>
            <button class="btn" id="autofill-tempering-btn">ููุก ุชููุงุฆู ูู ุงููุตูุฉ</button>
          </div>
          <div id="tempering-results-container" class="mt-10"></div>
          <div id="compatibility-alerts-container" class="mt-10"></div>
        </div>

        <div class="card">
          <h3>ูุญุงูุงุฉ ุงูุฎุจุฒ</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="oven-temp">ุญุฑุงุฑุฉ ุงููุฑู (ยฐC)</label>
              <input type="number" id="oven-temp" min="120" max="240" step="5" value="180">
            </div>
            <div class="input-group">
              <label for="baking-time">ุงูููุช (ุฏูููุฉ)</label>
              <input type="number" id="baking-time" min="3" max="20" step="1" value="7">
            </div>
            <div class="input-group">
              <label for="layer-thickness-simulation">ุณูุงูุฉ ุงูุทุจูุฉ (ูู)</label>
              <input type="number" id="layer-thickness-simulation" min="1" max="5" step="0.5" value="3">
            </div>
          </div>
          <div class="buttons-row">
            <button class="btn" id="simulate-baking-btn">ุชุดุบูู ุงููุญุงูุงุฉ</button>
          </div>
          <div id="baking-simulation-results" class="mt-10"></div>
        </div>

        <div class="card">
          <h3>ุงูุชูุฑูุฑ ุงูููููุงุฆู ุงูุดุงูู</h3>
          <div id="compatibility-report-container"></div>
        </div>

      </div>
    </section>

  </main>

  <footer class="app-footer">
    <div>ยฉ 2025 Medovik Smart Bakery OS โ ุฌููุน ุงูุญููู ูุญููุธุฉ</div>
  </footer>

  <!-- Load order: core.js โ fillings-data.js โ ui.js โ main.js โ app-controller.js -->
  <script src="core.js"></script>
  <script src="fillings-data.js"></script>
  <script src="ui.js"></script>
  <script src="main.js"></script>
  <script src="app-controller.js"></script>

  <!-- Tabs switcher (no inline handlers) -->
  <script>
    (function() {
      const nav = document.querySelector('.tabs-nav');
      const buttons = document.querySelectorAll('.tab-btn');
      const panels = document.querySelectorAll('.tab-panel');
      if (nav) {
        nav.addEventListener('click', (e) => {
          const btn = e.target.closest('.tab-btn');
          if (!btn) return;
          const id = btn.dataset.tab;
          buttons.forEach(b => b.classList.remove('active'));
          panels.forEach(p => p.classList.remove('active'));
          btn.classList.add('active');
          const panel = document.getElementById(id);
          if (panel) panel.classList.add('active');
        });
      }
      // Initialize some dynamic areas
      if (window.UIRenderer && typeof window.UIRenderer.renderDynamicFillingInputs === 'function') {
        window.UIRenderer.renderDynamicFillingInputs();
      }
    })();
  </script>
</body>
</html>